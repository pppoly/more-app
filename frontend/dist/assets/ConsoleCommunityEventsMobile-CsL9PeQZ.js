import{d as j,$ as z,l as F,r as p,c as r,z as N,g as V,B as J,o as P,a as o,e as s,h as v,t as u,i as _,F as g,f as C,a1 as R,u as U,b as n,j as w,_ as q}from"./index-OEpVzuiB.js";const G={class:"px-3 py-3 pb-20"},H={class:"mb-3"},K={class:"text-sm font-semibold text-slate-900"},O={class:"flex gap-2 mb-3 overflow-x-auto no-scrollbar"},Q=["onClick"],W={class:"bg-white rounded-2xl shadow-sm divide-y"},X=["onClick"],Y=["src"],Z={class:"flex-1 min-w-0 text-left"},ee={class:"text-[13px] font-semibold text-slate-900 line-clamp-2"},te={class:"mt-0.5 text-[11px] text-slate-400"},se={key:0,class:"px-3 py-4 text-center text-[11px] text-slate-400"},ae={key:1,class:"px-3 py-4 text-center text-[11px] text-slate-400"},le=j({__name:"ConsoleCommunityEventsMobile",setup(oe){const k=N(),d=U(),x=z(),{user:E}=F(),b=p([]),i=p(!1),c=p("all"),T=[{value:"all",label:"すべて"},{value:"open",label:"受付中"},{value:"closed",label:"終了"}],l=r(()=>k.params.communityId),B=r(()=>{const e=x.communities.value.find(a=>a.id===l.value);return(e==null?void 0:e.name)??"未選択"}),M=r(()=>{var e;return!!((e=E.value)!=null&&e.isAdmin)}),y=r(()=>b.value.map(e=>({id:e.id,title:V(e.title),status:e.status,dateTimeText:A(e.startTime,e.endTime),entrySummary:e.visibility==="public"?"公開イベント":"限定公開",coverUrl:"https://placehold.co/120x120?text=Event"}))),h=r(()=>c.value==="all"?y.value:y.value.filter(e=>e.status===c.value)),f=async()=>{if(l.value){i.value=!0;try{b.value=await R(l.value)}catch(e){console.error("Failed to load community events",e)}finally{i.value=!1}}};J(()=>l.value,()=>{l.value&&f()});const S=e=>{d.push({name:"ConsoleMobileEventManage",params:{eventId:e}})},D=()=>{l.value&&d.push({name:"ConsoleMobileEventCreate",params:{communityId:l.value}})},I=()=>{l.value&&d.push({name:"ConsoleMobileAssistantDashboard",params:{communityId:l.value}})},A=(e,a)=>{const t=new Date(e).toLocaleString("ja-JP",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});if(!a)return t;const m=new Date(a).toLocaleString("ja-JP",{hour:"2-digit",minute:"2-digit"});return`${t}〜${m}`},L=e=>{switch(e){case"open":return"受付中";case"closed":return"終了";default:return"下書き"}},$=e=>{switch(e){case"open":return"bg-emerald-100 text-emerald-700";case"closed":return"bg-slate-100 text-slate-500";default:return"bg-amber-100 text-amber-700"}};return P(async()=>{await x.loadCommunities(),l.value&&f()}),(e,a)=>(n(),o("div",G,[s("header",H,[a[1]||(a[1]=s("p",{class:"text-[11px] text-slate-400"},"コミュニティ",-1)),s("h1",K,u(B.value),1),a[2]||(a[2]=s("p",{class:"mt-0.5 text-[11px] text-slate-400"},"全てのイベント一覧",-1)),M.value?(n(),o("button",{key:0,type:"button",class:"dashboard-link",onClick:I},[...a[0]||(a[0]=[s("span",{class:"i-lucide-activity mr-1"},null,-1),_(" AI助手仪表盘 ",-1)])])):v("",!0)]),s("div",O,[(n(),o(g,null,C(T,t=>s("button",{key:t.value,class:w(["px-3 py-1 rounded-full text-xs border whitespace-nowrap",t.value===c.value?"bg-[#00B900] border-[#00B900] text-white":"bg-white border-slate-200 text-slate-600"]),onClick:m=>c.value=t.value},u(t.label),11,Q)),64))]),s("div",W,[(n(!0),o(g,null,C(h.value,t=>(n(),o("button",{key:t.id,class:"w-full px-3 py-2 flex items-center active:bg-slate-50",onClick:m=>S(t.id)},[s("img",{src:t.coverUrl,class:"w-10 h-10 rounded-xl object-cover mr-3 flex-shrink-0",alt:""},null,8,Y),s("div",Z,[s("p",ee,u(t.title),1),s("p",te,u(t.dateTimeText)+" · "+u(t.entrySummary),1)]),s("span",{class:w(["ml-2 px-2 py-0.5 rounded-full text-[10px]",$(t.status)])},u(L(t.status)),3)],8,X))),128)),!h.value.length&&!i.value?(n(),o("div",se," 条件に合うイベントがありません。 ")):v("",!0),i.value?(n(),o("div",ae,"読み込み中...")):v("",!0)]),s("div",{class:"mt-4"},[s("button",{type:"button",class:"create-event-button",onClick:D},[...a[3]||(a[3]=[s("span",{class:"i-lucide-plus mr-2 text-lg"},null,-1),_(" 新しいイベントを作成 ",-1)])])])]))}}),ue=q(le,[["__scopeId","data-v-bfbd6120"]]);export{ue as default};
