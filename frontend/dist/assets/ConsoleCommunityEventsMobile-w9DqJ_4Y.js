import{d as U,a6 as N,l as V,r as v,c as u,A as j,a as $,g as z,C as R,o as J,b as l,h as s,i as p,t as r,j as _,F as g,f as C,a9 as P,u as O,e as n,y as w,_ as q}from"./index-CT-XDF2b.js";const G={class:"px-3 py-3 pb-20"},H={class:"mb-3"},K={class:"text-sm font-semibold text-slate-900"},Q={class:"flex gap-2 mb-3 overflow-x-auto no-scrollbar"},W=["onClick"],X={class:"bg-white rounded-2xl shadow-sm divide-y"},Y=["onClick"],Z=["src"],ee={class:"flex-1 min-w-0 text-left"},te={class:"text-[13px] font-semibold text-slate-900 line-clamp-2"},se={class:"mt-0.5 text-[11px] text-slate-400"},ae={key:0,class:"px-3 py-4 text-center text-[11px] text-slate-400"},oe={key:1,class:"px-3 py-4 text-center text-[11px] text-slate-400"},le="https://raw.githubusercontent.com/moreard/dev-assets/main/socialmore/default-event.png",ne=U({__name:"ConsoleCommunityEventsMobile",setup(re){const k=j(),d=O(),x=N(),{user:E}=V(),b=v([]),i=v(!1),c=v("all"),T=[{value:"all",label:"すべて"},{value:"open",label:"受付中"},{value:"closed",label:"終了"}],o=u(()=>k.params.communityId),A=u(()=>{const e=x.communities.value.find(a=>a.id===o.value);return(e==null?void 0:e.name)??"未選択"}),I=u(()=>{var e;return!!((e=E.value)!=null&&e.isAdmin)}),y=u(()=>b.value.map(e=>({id:e.id,title:z(e.title),status:e.status,dateTimeText:S(e.startTime,e.endTime),entrySummary:e.visibility==="public"?"公開イベント":"限定公開",coverUrl:e.coverImageUrl?$(e.coverImageUrl):le}))),h=u(()=>c.value==="all"?y.value:y.value.filter(e=>e.status===c.value)),f=async()=>{if(o.value){i.value=!0;try{b.value=await P(o.value)}catch(e){console.error("Failed to load community events",e)}finally{i.value=!1}}};R(()=>o.value,()=>{o.value&&f()});const M=e=>{d.push({name:"ConsoleMobileEventManage",params:{eventId:e}})},B=()=>{o.value&&d.push({name:"ConsoleMobileEventForm",params:{communityId:o.value}})},D=()=>{o.value&&d.push({name:"ConsoleMobileAssistantDashboard",params:{communityId:o.value}})},S=(e,a)=>{const t=new Date(e).toLocaleString("ja-JP",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});if(!a)return t;const m=new Date(a).toLocaleString("ja-JP",{hour:"2-digit",minute:"2-digit"});return`${t}〜${m}`},F=e=>{switch(e){case"open":return"受付中";case"closed":return"終了";default:return"下書き"}},L=e=>{switch(e){case"open":return"bg-emerald-100 text-emerald-700";case"closed":return"bg-slate-100 text-slate-500";default:return"bg-amber-100 text-amber-700"}};return J(async()=>{await x.loadCommunities(),o.value&&f()}),(e,a)=>(n(),l("div",G,[s("header",H,[a[1]||(a[1]=s("p",{class:"text-[11px] text-slate-400"},"コミュニティ",-1)),s("h1",K,r(A.value),1),a[2]||(a[2]=s("p",{class:"mt-0.5 text-[11px] text-slate-400"},"全てのイベント一覧",-1)),I.value?(n(),l("button",{key:0,type:"button",class:"dashboard-link",onClick:D},[...a[0]||(a[0]=[s("span",{class:"i-lucide-activity mr-1"},null,-1),_(" AI助手仪表盘 ",-1)])])):p("",!0)]),s("div",Q,[(n(),l(g,null,C(T,t=>s("button",{key:t.value,class:w(["px-3 py-1 rounded-full text-xs border whitespace-nowrap",t.value===c.value?"bg-[#00B900] border-[#00B900] text-white":"bg-white border-slate-200 text-slate-600"]),onClick:m=>c.value=t.value},r(t.label),11,W)),64))]),s("div",X,[(n(!0),l(g,null,C(h.value,t=>(n(),l("button",{key:t.id,class:"w-full px-3 py-2 flex items-center active:bg-slate-50",onClick:m=>M(t.id)},[s("img",{src:t.coverUrl,class:"w-10 h-10 rounded-xl object-cover mr-3 flex-shrink-0",alt:""},null,8,Z),s("div",ee,[s("p",te,r(t.title),1),s("p",se,r(t.dateTimeText)+" · "+r(t.entrySummary),1)]),s("span",{class:w(["ml-2 px-2 py-0.5 rounded-full text-[10px]",L(t.status)])},r(F(t.status)),3)],8,Y))),128)),!h.value.length&&!i.value?(n(),l("div",ae," 条件に合うイベントがありません。 ")):p("",!0),i.value?(n(),l("div",oe,"読み込み中...")):p("",!0)]),s("div",{class:"mt-4"},[s("button",{type:"button",class:"create-event-button",onClick:B},[...a[3]||(a[3]=[s("span",{class:"i-lucide-plus mr-2 text-lg"},null,-1),_(" 新しいイベントを作成 ",-1)])])])]))}}),ie=q(ne,[["__scopeId","data-v-18222350"]]);export{ie as default};
