import{d as D,Q as N,r as _,c as i,g as R,A as $,o as j,a as c,e as t,j as b,t as l,n as d,h as F,F as V,f as z,R as H,u as J,b as r,_ as Q}from"./index-BPws346P.js";const U={class:"console-home"},q={class:"hero-card"},G={class:"hero-title"},K={class:"hero-role"},O={class:"hero-stats"},W={class:"hero-stat"},X={class:"hero-stat"},Y={class:"hero-stat"},Z={class:"action-grid"},tt={class:"events-section"},st={class:"event-cards"},et=["onClick"],nt={class:"event-date"},ot={class:"event-meta"},at={key:0,class:"event-empty"},lt=D({__name:"ConsoleHomeMobile",setup(it){const u=J(),m=N(),p=_([]),y=_(!1),C=i(()=>m.getActiveCommunity()),w=i(()=>{var e;return((e=C.value)==null?void 0:e.name)??""}),n=i(()=>m.activeCommunityId.value),a=i(()=>!!n.value),E=i(()=>{var s;switch((s=C.value)==null?void 0:s.role){case"owner":return"主催者";case"admin":return"管理者";default:return"メンバー"}}),v=i(()=>({monthRevenueText:"¥0",eventCount:p.value.length,registrationCount:"--"})),h=i(()=>p.value.slice(0,5).map(e=>({id:e.id,title:R(e.title),status:e.status,dateTimeText:I(e.startTime,e.endTime),entrySummary:e.visibility==="public"?"公開イベント":"限定公開",coverUrl:"https://placehold.co/120x120?text=Event"}))),g=async()=>{if(n.value){y.value=!0;try{p.value=await H(n.value)}catch(e){console.error("Failed to load console events",e)}finally{y.value=!1}}};$(n,()=>{n.value&&g()});const T=()=>{window.dispatchEvent(new CustomEvent("console:open-community-picker"))},f=()=>{u.push({name:"ConsoleMobileCommunityCreate"})},M=()=>{u.push({name:"ConsoleMobilePayout"})},S=()=>{u.push({name:"ConsoleMobileSubscription"})},k=()=>{n.value&&u.push({name:"ConsoleMobileCommunityEvents",params:{communityId:n.value}})},L=e=>{u.push({name:"ConsoleMobileEventManage",params:{eventId:e}})},B=()=>{n.value&&u.push({name:"ConsoleMobileEventCreate",params:{communityId:n.value}})},I=(e,s)=>{const o=new Date(e).toLocaleString("ja-JP",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});if(!s)return o;const x=new Date(s).toLocaleString("ja-JP",{hour:"2-digit",minute:"2-digit"});return`${o}〜${x}`},P=e=>{switch(e){case"open":return"受付中";case"closed":return"終了";default:return"下書き"}},A=e=>{switch(e){case"open":return"bg-emerald-100 text-emerald-700";case"closed":return"bg-slate-100 text-slate-500";default:return"bg-amber-100 text-amber-700"}};return j(async()=>{await m.loadCommunities(),n.value||m.ensureActiveCommunity(),n.value&&g()}),(e,s)=>(r(),c("div",U,[t("section",q,[s[5]||(s[5]=t("div",{class:"hero-chip"},[t("span",{class:"i-lucide-layout-dashboard text-sm"}),b(" Console ")],-1)),s[6]||(s[6]=t("p",{class:"hero-subtitle"},"運営コミュニティ",-1)),t("h1",G,l(w.value||"未選択のコミュニティ"),1),t("p",K,l(a.value?`役割: ${E.value}`:"まずはコミュニティを登録しましょう"),1),a.value?(r(),c("button",{key:0,class:"hero-switch",type:"button",onClick:T},[...s[0]||(s[0]=[t("span",{class:"i-lucide-building-2"},null,-1),b(" コミュニティを切り替える ",-1)])])):(r(),c("button",{key:1,class:"hero-switch hero-switch--primary",type:"button",onClick:f},[...s[1]||(s[1]=[t("span",{class:"i-lucide-sparkles"},null,-1),b(" コミュニティを作成 ",-1)])])),t("div",O,[t("div",W,[s[2]||(s[2]=t("p",null,"今月の収入",-1)),t("strong",null,l(a.value?v.value.monthRevenueText:"---"),1)]),t("div",X,[s[3]||(s[3]=t("p",null,"今月のイベント",-1)),t("strong",null,l(a.value?v.value.eventCount:"--"),1)]),t("div",Y,[s[4]||(s[4]=t("p",null,"申込数",-1)),t("strong",null,l(a.value?v.value.registrationCount:"--"),1)])])]),t("section",Z,[t("button",{class:"action-card",type:"button",onClick:f},[...s[7]||(s[7]=[t("span",{class:"action-icon i-lucide-sparkles"},null,-1),t("div",null,[t("p",{class:"action-title"},"コミュニティ作成"),t("p",{class:"action-desc"},"新しいコミュニティを登録")],-1)])]),t("button",{class:d(["action-card",{"is-disabled":!a.value}]),type:"button",onClick:B},[...s[8]||(s[8]=[t("span",{class:"action-icon i-lucide-plus"},null,-1),t("div",null,[t("p",{class:"action-title"},"新しいイベント"),t("p",{class:"action-desc"},"イベントを作成して公開")],-1)])],2),t("button",{class:d(["action-card",{"is-disabled":!a.value}]),type:"button",onClick:k},[...s[9]||(s[9]=[t("span",{class:"action-icon i-lucide-calendar-search"},null,-1),t("div",null,[t("p",{class:"action-title"},"イベント管理"),t("p",{class:"action-desc"},"登録状況と参加者を確認")],-1)])],2),t("button",{class:d(["action-card",{"is-disabled":!a.value}]),type:"button",onClick:M},[...s[10]||(s[10]=[t("span",{class:"action-icon i-lucide-piggy-bank"},null,-1),t("div",null,[t("p",{class:"action-title"},"収益と入金"),t("p",{class:"action-desc"},"入金設定・請求を確認")],-1)])],2),t("button",{class:d(["action-card",{"is-disabled":!a.value}]),type:"button",onClick:S},[...s[11]||(s[11]=[t("span",{class:"action-icon i-lucide-settings"},null,-1),t("div",null,[t("p",{class:"action-title"},"プランと設定"),t("p",{class:"action-desc"},"プラン変更や通知設定")],-1)])],2)]),t("section",tt,[t("div",{class:"section-head"},[s[12]||(s[12]=t("div",null,[t("p",{class:"section-label"},"イベントの進行状況"),t("h2",null,"最新イベント")],-1)),t("button",{class:"link-button",type:"button",onClick:k},"一覧を見る")]),t("div",st,[(r(!0),c(V,null,z(h.value,o=>(r(),c("button",{key:o.id,class:"event-card",type:"button",onClick:x=>L(o.id)},[t("div",{class:d(["event-status",A(o.status)])},l(P(o.status)),3),t("p",nt,l(o.dateTimeText),1),t("h3",null,l(o.title),1),t("p",ot,l(o.entrySummary),1)],8,et))),128)),h.value.length?F("",!0):(r(),c("div",at," まだイベントがありません。新しい企画を始めましょう。 "))])])]))}}),ct=Q(lt,[["__scopeId","data-v-743c6c19"]]);export{ct as default};
