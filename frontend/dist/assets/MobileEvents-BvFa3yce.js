import{d as R,u as A,r as p,c as k,g as U,o as P,a as n,b as o,e as a,F as i,f as r,n as _,t as l,h as V,i as B,j as x,k as H,_ as F}from"./index-BPws346P.js";const W={class:"mobile-events-page"},q={class:"filter-tabs no-scrollbar"},J=["onClick"],G={key:0,class:"state-section"},K={key:1,class:"state-section"},Q={key:2,class:"card-list"},X={key:0,class:"state-empty"},Y=["onClick"],Z={class:"event-card__date-pill"},tt={class:"event-card__body"},et={class:"event-card__title"},at={class:"event-card__meta"},st={class:"event-card__location"},nt={class:"event-card__organizer"},ot={class:"organizer-avatar"},ct=["src"],lt={class:"organizer-info"},it={class:"organizer-name"},rt={class:"organizer-status"},ut={class:"event-card__capacity"},dt={class:"event-card__attendees"},pt={class:"avatar-stack"},_t=["src"],mt={class:"mobile-bottom-nav"},vt=["onClick"],gt={class:"bottom-nav__label"},ht=R({__name:"MobileEvents",setup(bt){const m=A(),v=p([]),g=p(!0),h=p(null),u=p("all"),T=[{value:"all",label:"すべて"},{value:"parent",label:"親子"},{value:"sports",label:"スポーツ"},{value:"language",label:"語学交換"},{value:"work",label:"仕事・スキル"}],C=[{id:"home",label:"トップ",path:"/",icon:"i-lucide-home"},{id:"events",label:"活動",path:"/events",icon:"i-lucide-calendar-days"},{id:"me",label:"マイページ",path:"/me",icon:"i-lucide-user-round"},{id:"settings",label:"設定",path:"/settings",icon:"i-lucide-cog"}],S=[{id:"mock-001",status:"open",title:{ja:"代々木公園ピクニック交流"},description:null,locationText:"代々木公園",startTime:new Date().toISOString(),coverImageUrl:"https://placehold.jp/640x360.png?text=MORE",category:"parent",community:{id:"c-1",name:"Tokyo Language Lounge"},ticketTypes:[{price:0}],config:{currentParticipants:24,capacity:30}},{id:"mock-002",status:"closed",title:{ja:"語学交換ミートアップ"},description:null,locationText:"渋谷スクランブルスクエア",startTime:new Date(Date.now()+864e5).toISOString(),coverImageUrl:"https://placehold.jp/640x360.png?text=Meetup",category:"language",community:{id:"c-2",name:"SOCIALMORE"},ticketTypes:[{price:1500}],config:{currentParticipants:18,capacity:20}}],b=async()=>{g.value=!0,h.value=null;try{v.value=await H()}catch(t){console.warn("fetchEvents failed, using fallback data",t),v.value=S,h.value="現在の環境ではデモデータを表示しています。"}finally{g.value=!1}},y=k(()=>v.value.map(t=>{var s;return{id:t.id,title:U(t.title),category:(t.category??"").toLowerCase(),coverUrl:t.coverImageUrl??"https://placehold.jp/640x360.png?text=MORE",dateText:D(t.startTime),timeText:M(t.startTime),locationText:t.locationText,organizerName:((s=t.community)==null?void 0:s.name)??"SOCIALMORE",statusLabel:I(t.status),statusClass:j(t.status),statusHint:L(t.status),capacityText:$(t),clubAvatar:N(t),attendees:O(t)}}).filter(t=>u.value==="all"||t.category.includes(u.value))),E=t=>{m.push({name:"event-detail",params:{eventId:t}})},w=t=>{m.push(t)},z=k(()=>{const t=m.currentRoute.value.path;return t.startsWith("/settings")?"settings":t.startsWith("/me")?"me":t==="/"?"home":"events"}),I=t=>t==="open"?"参加募集中":t==="closed"?"受付終了":"告知予定",L=t=>t==="open"?"いま参加できます":t==="closed"?"次回をお待ちください":"予定調整中",j=t=>t==="open"?"event-card__status--open":t==="closed"?"event-card__status--closed":"event-card__status--info",D=t=>{const s=new Date(t);return`${(s.getMonth()+1).toString().padStart(2,"0")}/${s.getDate().toString().padStart(2,"0")}`},M=t=>new Date(t).toLocaleString("ja-JP",{month:"long",day:"numeric",weekday:"short",hour:"2-digit",minute:"2-digit"}),$=t=>{var d,f;const s=t.config??{},e=s.currentParticipants??0,c=s.capacity??((f=(d=t.ticketTypes)==null?void 0:d[0])==null?void 0:f.quota)??0;return c?`${e}/${c}`:`${e}/∞`},O=t=>((t.config??{}).attendeeAvatars??["https://randomuser.me/api/portraits/women/1.jpg","https://randomuser.me/api/portraits/men/2.jpg","https://randomuser.me/api/portraits/women/3.jpg"]).slice(0,4),N=t=>{var e,c;const s=((c=(e=t.community)==null?void 0:e.name)==null?void 0:c[0])??"S";return`https://api.dicebear.com/7.x/initials/svg?seed=${encodeURIComponent(s)}`};return P(b),(t,s)=>(o(),n("div",W,[s[5]||(s[5]=a("header",{class:"events-hero"},[a("div",{class:"hero-chip"},"MORE EVENTS"),a("h1",null,"開催中のイベント"),a("p",null,"気になるイベントをタップして詳細を確認しよう。")],-1)),a("section",q,[(o(),n(i,null,r(T,e=>a("button",{key:e.value,class:_(["filter-tab",{"filter-tab--active":e.value===u.value}]),onClick:c=>u.value=e.value},l(e.label),11,J)),64))]),g.value?(o(),n("section",G,[(o(),n(i,null,r(3,e=>a("article",{key:e,class:"event-card event-card--skeleton"})),64))])):h.value?(o(),n("section",K,[a("article",{class:"state-card"},[s[0]||(s[0]=a("p",null,"イベントの読み込みに失敗しました。",-1)),a("button",{type:"button",onClick:b},"再読み込み")])])):(o(),n("section",Q,[y.value.length?V("",!0):(o(),n("p",X,"条件に合うイベントが見つかりません。")),(o(!0),n(i,null,r(y.value,e=>(o(),n("article",{key:e.id,class:"event-card",onClick:c=>E(e.id)},[a("figure",{class:"event-card__cover",style:B({backgroundImage:`url(${e.coverUrl})`})},[s[1]||(s[1]=a("div",{class:"event-card__cover-overlay"},null,-1)),a("div",Z,l(e.dateText),1),a("div",{class:_(["event-card__status",e.statusClass])},l(e.statusLabel),3)],4),a("div",tt,[a("h2",et,l(e.title),1),a("p",at,[s[2]||(s[2]=a("span",{class:"i-lucide-calendar text-xs"},null,-1)),x(" "+l(e.timeText),1)]),a("p",st,[s[3]||(s[3]=a("span",{class:"i-lucide-map-pin text-xs"},null,-1)),x(" "+l(e.locationText),1)]),a("div",nt,[a("div",ot,[a("img",{src:e.clubAvatar,alt:"organizer"},null,8,ct)]),a("div",lt,[a("p",it,l(e.organizerName),1),a("span",rt,l(e.statusHint),1)]),a("div",ut,l(e.capacityText),1)]),a("div",dt,[a("div",pt,[(o(!0),n(i,null,r(e.attendees,(c,d)=>(o(),n("img",{key:d,src:c,alt:"attendee"},null,8,_t))),128))]),s[4]||(s[4]=a("button",{class:"event-card__cta",type:"button"},"詳細を見る",-1))])])],8,Y))),128))])),a("nav",mt,[(o(),n(i,null,r(C,e=>a("button",{key:e.id,class:_(["bottom-nav__item",{"bottom-nav__item--active":e.id===z.value}]),onClick:c=>w(e.path)},[a("span",{class:_(["bottom-nav__icon",e.icon])},null,2),a("span",gt,l(e.label),1)],10,vt)),64))])]))}}),ft=F(ht,[["__scopeId","data-v-557313df"]]);export{ft as default};
