import{a2 as jt,d as Vt,$ as Ut,c as k,z as Jt,r as h,A as Bt,B as Qt,o as Gt,U as Ht,a,e as n,h as d,t as u,i as _,F as S,f as C,v as Yt,x as Kt,a3 as Wt,n as Zt,a4 as Xt,g as te,a5 as ee,a6 as se,a7 as ne,a8 as ie,a9 as dt,u as ae,b as o,j as oe,Y as le,_ as re}from"./index-X7Vbb3kp.js";const ht=["title","description","startTime","locationText","ticketTypes","visibility","registrationFormSchema"],ue=`${jt}

---
You are the SOCIALMORE Event Creation Assistant.
- Mission: understand the organizer's intention, encourage them when they hesitate, and then help them commit to clear written decisions.
- Persona: warm coach at first, precise editor later. Never turn the conversation into a rigid form.
- Languages: default to Japanese, but mirror the user's input language when possible.
- Process: Listen (感性) → Guide (構造化) → Write (草稿を提示) → Confirm (ユーザーに最終判断を委ねる).`,ce={coach:`Current stage: 感性モード (Coach).
Goals:
- Surface the organizer's motivation, people they want to help, and desired vibe.
- Translate vague wishes into tangible goals.
- Ask one focused question at a time; do not rush into fields or checklists.
Forbidden:
- Empty hype (e.g., "必ず成功します").
- Ignoring obvious fears or blockers the organizer mentions.`,editor:`Current stage: 理性モード (Editor).
Goals:
- Organize concrete decisions (title, time, location, ticketing, requirements).
- Offer options with pros/cons when the organizer hesitates.
- Highlight contradictions or risks (e.g., "想要開放但又限定費用很高").
Guidelines:
- Provide concise bullet structures or A/B drafts.
- Ask clarifying questions only for the missing fields listed below.`,writer:`Current stage: ライティング / 確認.
Goals:
- Summarize the EventDraft so the organizer can confirm or adjust.
- Clearly list every key field (title, schedule, ticketing, requirements, notes).
- Invite the organizer to edit specific parts instead of rewriting everything.
If something is still missing, politely mention it before presenting the summary.`},pe='Reply with:\n1) A short natural-language response following the current stage instructions.\n2) If you update the draft, append a JSON block using ```json ... ``` that contains { "type": "event_draft_update", "data": Partial<EventDraft> }.\nNever invent data that the organizer has not provided.';function de(i){if(!i)return"coach";const v=!!(typeof i.title=="string"&&i.title.trim()||i.purpose||i.description||i.category||i.targetAudience),b=ht.every(f=>{const y=i[f];return y==null?!1:Array.isArray(y)?y.length>0:typeof y=="string"?y.trim().length>0:!0});return v?b?"writer":"editor":"coach"}function ve(i){var b;if(!i)return"No draft data yet.";const v=[];if(i.title&&v.push(`Title: ${j(i.title)}`),i.subtitle&&v.push(`Subtitle: ${j(i.subtitle)}`),i.purpose&&v.push(`Purpose: ${j(i.purpose)}`),i.description&&v.push(`Description: ${j(i.description)}`),i.startTime&&v.push(`Start: ${i.startTime}`),i.endTime&&v.push(`End: ${i.endTime}`),i.locationText&&v.push(`Location: ${i.locationText}`),i.ticketTypes&&i.ticketTypes.length){const f=i.ticketTypes.map(y=>`${j(y.name)} ¥${y.price??0}`).join(", ");v.push(`Ticketing: ${f}`)}return i.requirements&&i.requirements.length&&v.push(`Requirements: ${i.requirements.map(f=>f.label).join(", ")}`),(b=i.config)!=null&&b.riskNoticeEnabled&&v.push("Risk notice is enabled."),v.length?v.join(`
`):"Draft exists but has no descriptive fields yet."}function j(i){return i==null?"":typeof i=="string"?i:typeof i=="object"&&"original"in i?String(i.original??""):JSON.stringify(i)}function ye(i){if(!i)return"All fields missing.";const v=ht.filter(b=>{const f=i[b];return f==null?!0:Array.isArray(f)?f.length===0:typeof f=="string"?f.trim().length===0:!1});return v.length?`Fields still missing: ${v.join(", ")}`:"Required fields are present."}function he(i){const v=i.explicitStage??de(i.draft),b=i.locale==="zh"?"回答は簡体字中文でもよいですが、ユーザーの入力言語に合わせてください。":i.locale==="en"?"Respond in English unless the organizer prefers Japanese.":"回答は日本語をベースに、ユーザーの言語に合わせてカスタマイズしてください。",f=[i.userName?`Organizer: ${i.userName}`:null,i.communityName?`Community: ${i.communityName}`:null,i.lastUserUtterance?`Latest user message: ${i.lastUserUtterance}`:null].filter(Boolean).join(`
`),y=[ue,b,ce[v],`Draft context:
${ve(i.draft)}`,ye(i.draft),pe].concat(f?[`
Context:
${f}`]:[]).join(`

`);return{stage:v,prompt:y}}const fe={class:"assistant-chat-surface"},ge={class:"chat-tools"},me={class:"status-chip"},ke={class:"mode-chip"},be={class:"prompt-chip"},we={key:0,class:"history-panel"},_e={key:0,class:"history-empty"},Se={key:1,class:"history-list"},Ce={class:"history-meta"},Te={class:"history-actions"},Ae=["onClick"],$e=["onClick"],Pe={key:0,class:"chat-text-block"},Ee={class:"chat-text"},Le={key:1,class:"chat-options"},xe={class:"chat-options-question"},Ie={key:0,class:"chat-options-note"},Ne={key:2,class:"thinking-inline"},De={class:"thinking-inline-index"},Oe={class:"thinking-inline-text"},Re={key:3,class:"coach-prompts"},qe={key:4,class:"editor-checklist"},ze={key:5,class:"writer-summary"},Fe={class:"writer-summary-grid"},Me={key:0},je={key:1},Ve={key:2},Ue={key:3},Je={key:4},Be={key:0,class:"writer-confirm"},Qe={key:1,class:"proposal-card"},Ge={class:"proposal-title"},He={class:"proposal-desc"},Ye={class:"chat-meta"},Ke={key:1,class:"thinking-banner"},We={key:2,class:"assistant-error"},Ze={key:0,class:"final-plan-card"},Xe={class:"final-plan-title"},ts={key:0,class:"final-plan-section"},es={class:"final-plan-text"},ss={class:"final-plan-grid"},ns={key:0},is={class:"final-plan-text"},as={key:1},os={class:"final-plan-text"},ls={key:1,class:"final-plan-section"},rs={class:"final-plan-list"},us={key:2,class:"final-plan-section"},cs={class:"final-plan-ticket-list"},ps={key:3,class:"final-plan-section"},ds={class:"final-plan-list"},vs={key:4,class:"final-plan-section"},ys={class:"final-plan-list"},hs={class:"assistant-bottom"},fs={class:"chat-input-row"},gs=["placeholder"],ms=["disabled"],ks={key:0,class:"final-plan-actions"},bs=["disabled"],vt="console-ai-assistant-history",yt="console-ai-assistant-drafts",ws=Vt({__name:"ConsoleEventAssistantMobile",setup(i){const v=Jt(),b=ae(),f=Ut(),y=k(()=>v.params.communityId);k(()=>{const t=y.value;if(!t)return"";const s=f.communities.value.find(e=>e.id===t);return(s==null?void 0:s.name)??""});const V=h(null),z=h(!1),c=Bt({baseLanguage:"ja",topic:"",audience:"",style:"",details:""}),U=[{key:"topic",prompt:"どんなイベントを企画していますか？（例：親子BBQ、言語交換など）"},{key:"audience",prompt:"主な対象や届けたい人は誰ですか？"},{key:"style",prompt:"雰囲気やスタイルはどうしたいですか？（family-friendly / casual など）"},{key:"details",prompt:"場所・所要時間・持ち物など、補足したいことを自由にどうぞ。"}],T=h([]),Y=h(null),K=h(0),ft=k(()=>({"--keyboard-offset":`${K.value}px`})),L=h(""),J=h(!1),F=h(null),r=h(null),M=h(0),W=h(!1),x=h([]),B=h(!1),Z=h("collecting"),Q=h("coach-v2"),G=h("coach"),$=h(null),gt={coach:"模式：Coach（点火）",editor:"模式：Editor（打灯）",writer:"模式：Writer（草稿确认）"},mt=h(0),kt=h("ja"),bt=k(()=>{switch(Z.value){case"ready":return"方案已生成";case"options":return"候选提案";default:return"信息收集中"}}),I=h({baseLanguage:"zh",topic:"コミュニティイベント",audience:"地域の仲間",style:"family-friendly"}),X=k(()=>{var t;for(let s=T.value.length-1;s>=0;s-=1){const e=T.value[s];if(e.role==="assistant"&&((t=e.coachPrompts)!=null&&t.length))return e.coachPrompts}return[]}),tt=h([]),et=h([]),wt=k(()=>r.value?g(r.value.title)||c.topic||"AI 提案":""),st=k(()=>{var e;const t=(e=r.value)==null?void 0:e.logistics;if(!t)return[];const s=[];return t.startTime&&s.push({label:"开始时间",value:formatDateTime(t.startTime)}),t.endTime&&s.push({label:"结束时间",value:formatDateTime(t.endTime)}),t.locationText&&s.push({label:"地点",value:t.locationText}),t.locationNote&&s.push({label:"地点备注",value:t.locationNote}),s}),nt=k(()=>{var t;return((t=r.value)==null?void 0:t.ticketTypes)??[]}),it=k(()=>{var t;return((t=r.value)==null?void 0:t.requirements)??[]}),at=k(()=>{var t;return((t=r.value)==null?void 0:t.registrationForm)??[]}),_t=t=>t==null?"免费":`¥${t.toLocaleString("ja-JP")}`,St=k(()=>({title:c.topic||"",description:c.details||c.topic,targetAudience:c.audience,vibe:c.style,locationText:c.details,ticketTypes:[],registrationFormSchema:[]})),Ct=k(()=>$.value?$.value:X.value.length?X.value[0]:M.value>=U.length?"追加で伝えたいことや質問を入力してください":U[M.value].prompt);Qt(()=>y.value,()=>{z.value=!1,ot()});const Tt=()=>{le(()=>{const t=Y.value;t&&(t.scrollTop=t.scrollHeight)})},N=(t,s,e,p,m,D,A,O,R,E,l)=>{T.value.push({id:`${Date.now()}-${Math.random().toString(36).slice(2)}`,role:t,type:s,content:e,createdAt:new Date().toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"}),payload:p,action:m,options:D,thinkingSteps:A&&A.length?A:void 0,coachPrompts:O,editorChecklist:R,writerSummary:E,confirmQuestions:l}),T.value.length>200&&T.value.shift(),Tt()},ot=async()=>{if(!y.value){V.value=null,z.value=!1,await lt();return}try{V.value=await Xt(y.value)}catch(t){console.warn("Failed to load community detail",t),V.value=null}finally{z.value=!1,await lt()}},lt=async()=>{if(z.value)return;z.value=!0;const t=V.value,s=t!=null&&t.description?te(t.description):"",e=(t==null?void 0:t.name)??"Tokyo Community Organizations Meetup Group",p=s?`コミュニティ紹介：${e}
${s}

上記の背景を踏まえて、主催者が最初のアイデアを話しやすいようCoachモードで歓迎し、最初の質問を投げかけてください。`:"コミュニティ紹介情報はありません。主催者を歓迎し、最初のアイデアを引き出す質問から始めてください。";await ut(p,{overrideSummary:`コミュニティ紹介: ${e}`})},rt=async()=>{if(!L.value.trim()||J.value)return;const t=L.value.trim();L.value="",N("user","text",t),await Pt(t)},At=t=>/[\u4e00-\u9fff]/.test(t)?"zh":/[a-zA-Z]/.test(t)?"en":"ja",$t=t=>{const s=At(t);s&&c.baseLanguage!==s&&(c.baseLanguage=s)},Pt=async t=>{$t(t);const s=U[M.value];s&&(c[s.key]=t),M.value<U.length-1&&(M.value+=1),$.value=null,await ut(t)},ut=async(t,s)=>{var E;F.value=null;const e=(s==null?void 0:s.overrideSummary)??pt(t),{stage:p,prompt:m}=he({draft:St.value,locale:c.baseLanguage||"ja",lastUserUtterance:t});G.value=p;const D=qt(),A=`${e}

--- Conversation ---
${D}

--- Assistant Prompt ---
${m}`,O=zt(),R={baseLanguage:P(c.baseLanguage,"baseLanguage"),topic:P(c.topic,"topic"),audience:P(c.audience,"audience"),style:P(c.style,"style"),details:A,conversation:O};J.value=!0;try{const l=await ee(R),w=Array.isArray(l.thinkingSteps)?l.thinkingSteps:[];Z.value=l.status,Q.value=l.promptVersion,mt.value=l.turnCount,kt.value=l.language,l.stage&&["coach","editor","writer"].includes(l.stage)&&(G.value=l.stage),tt.value=l.editorChecklist??[],et.value=l.confirmQuestions??[],N("assistant","text",l.message,void 0,void 0,l.options,w,l.coachPrompts,l.editorChecklist,l.writerSummary,l.confirmQuestions),$.value=((E=l.options)==null?void 0:E[0])??null;let q=null;if((l.status==="ready"||l.status==="options"||!!l.proposal)&&l.stage==="writer"){q={...l.proposal??await se({baseLanguage:c.baseLanguage||"ja",topic:c.topic||"コミュニティイベント",audience:c.audience||"地域の仲間",style:c.style||"family-friendly",details:e}),summary:e},r.value=q;const Ft=g(q.title),Mt=g(q.description);N("assistant","proposal","",{title:Ft,description:Mt,raw:r.value})}else r.value=null,$.value=null;await Et(p,e,{status:l.status,promptVersion:l.promptVersion,turnCount:l.turnCount,language:l.language,options:l.options??[],coachPrompts:l.coachPrompts??[],editorChecklist:l.editorChecklist??[],writerSummary:l.writerSummary??null}),q&&Lt(q)}catch(l){F.value=l instanceof Error?l.message:"AI生成に失敗しました。少し時間を置いて再度お試しください。",N("assistant","text",F.value??"AI生成に失敗しました。")}finally{J.value=!1,$.value||($.value=null)}},Et=async(t,s,e)=>{if(y.value)try{W.value=!0;const p=T.value.map(m=>({id:m.id,role:m.role,type:m.type,content:m.content,createdAt:m.createdAt,payload:m.payload?{title:m.payload.title??null,description:m.payload.description??null}:null}));await ne(y.value,{stage:t,summary:s,qaState:JSON.parse(JSON.stringify(c)),messages:p,aiResult:r.value?{title:r.value.title,description:r.value.description,notes:r.value.notes,riskNotice:r.value.riskNotice}:null,promptVersion:e==null?void 0:e.promptVersion,status:e==null?void 0:e.status,turnCount:e==null?void 0:e.turnCount,language:e==null?void 0:e.language,meta:{options:(e==null?void 0:e.options)??[],coachPrompts:(e==null?void 0:e.coachPrompts)??[],editorChecklist:(e==null?void 0:e.editorChecklist)??[],writerSummary:(e==null?void 0:e.writerSummary)??null}})}catch(p){console.warn("Failed to save assistant log",p)}finally{W.value=!1}},Lt=t=>{const s={id:`${Date.now()}-${Math.random().toString(36).slice(2)}`,createdAt:Date.now(),summary:t.summary,title:g(t.title),description:g(t.description),raw:t};x.value=[s,...x.value].slice(0,10),localStorage.setItem(vt,JSON.stringify(x.value))},xt=()=>{const t=localStorage.getItem(vt);if(t)try{const s=JSON.parse(t);x.value=s}catch(s){console.warn("Failed to parse assistant history",s)}},It=t=>{if(!t)return;const s=localStorage.getItem(yt);let e=[];if(s)try{e=JSON.parse(s)}catch{e=[]}e=[{id:`${Date.now()}-${Math.random().toString(36).slice(2)}`,createdAt:Date.now(),summary:t.summary||"",title:g(t.title),description:g(t.description),raw:t},...e].slice(0,10),localStorage.setItem(yt,JSON.stringify(e)),N("assistant","text","この案を草稿として保存しました。履歴からいつでも復元できます。")},Nt=t=>{t&&(r.value={...t,summary:t.summary||pt()},H(!0))},Dt=t=>{r.value={...t.raw,summary:t.summary},N("assistant","proposal","",{title:t.title,description:t.description,raw:r.value}),B.value=!1},ct=()=>{B.value=!B.value},Ot=async()=>{try{const t=await ie();I.value=t.defaults,Q.value=t.version,Rt()}catch(t){console.warn("Failed to load assistant defaults",t)}},Rt=()=>{c.baseLanguage||(c.baseLanguage=I.value.baseLanguage),c.topic||(c.topic=I.value.topic),c.audience||(c.audience=I.value.audience),c.style||(c.style=I.value.style)},pt=t=>`AIの理解：対象は「${P(c.audience,"audience")}」、イベントは「${P(c.topic,"topic")}」、雰囲気は「${P(c.style,"style")}」。補足情報: ${t||c.details||"特記事項なし"}`,qt=()=>T.value.slice(-8).map(t=>{var p,m;const s=t.role==="user"?"User":"Assistant",e=t.type==="text"?t.content:`提案: ${((p=t.payload)==null?void 0:p.title)??""} ${((m=t.payload)==null?void 0:m.description)??""}`;return`${s}: ${e}`}).join(`
`),zt=()=>T.value.slice(-10).map(t=>{var s,e;return{role:t.role,content:t.type==="text"?t.content:`提案: ${((s=t.payload)==null?void 0:s.title)??""} ${((e=t.payload)==null?void 0:e.description)??""}`}}),P=(t,s)=>t&&t.trim()?t:I.value[s],g=t=>t?typeof t=="string"?t:typeof t=="object"&&t.original?t.original:"":"",H=t=>{y.value&&(t&&r.value?sessionStorage.setItem(dt,JSON.stringify({title:g(r.value.title),subtitle:g(r.value.subtitle),description:g(r.value.description),notes:g(r.value.notes),riskNotice:g(r.value.riskNotice),logistics:r.value.logistics??null,ticketTypes:r.value.ticketTypes??[],requirements:r.value.requirements??[],registrationForm:r.value.registrationForm??[],visibility:r.value.visibility??"public",checklist:tt.value,confirmQuestions:et.value,generatedAt:Date.now()})):sessionStorage.removeItem(dt),window.alert("AI案をフォームに送信します。次の画面で各項目を確認してください。"),b.push({name:"ConsoleMobileEventForm",params:{communityId:y.value},query:{source:"ai-assistant"}}))};return Gt(async()=>{if(await Ot(),await f.loadCommunities(),y.value&&f.setActiveCommunity(y.value),xt(),await ot(),typeof window<"u"&&window.visualViewport){const t=()=>{const s=window.visualViewport,e=window.innerHeight,p=Math.max(0,e-s.height-s.offsetTop);K.value=p};window.visualViewport.addEventListener("resize",t),window.visualViewport.addEventListener("scroll",t),t(),Ht(()=>{var s,e;(s=window.visualViewport)==null||s.removeEventListener("resize",t),(e=window.visualViewport)==null||e.removeEventListener("scroll",t)})}}),(t,s)=>(o(),a("div",{class:"assistant-screen",style:Zt(ft.value)},[n("section",fe,[n("div",ge,[n("span",me,u(bt.value),1),n("span",ke,u(gt[G.value]),1),n("span",be,"Prompt "+u(Q.value),1),n("button",{type:"button",class:"history-toggle",onClick:ct},[...s[4]||(s[4]=[n("span",{class:"i-lucide-clock-4"},null,-1),_(" 会话历史 ",-1)])])]),s[19]||(s[19]=n("section",{class:"assistant-guide"},[n("p",{class:"guide-title"},"SOCIALMORE AI 使用说明"),n("ol",null,[n("li",null,[n("strong",null,"Speak"),_("：随便说出你的想法或需求。")]),n("li",null,[n("strong",null,"Guide"),_("：AI Coach/Editor 会提问，逐条回答即可。")]),n("li",null,[n("strong",null,"Write"),_("：完成提问后，AI 会生成方案，并可一键送表单或存草案。")])])],-1)),B.value?(o(),a("div",we,[n("div",{class:"history-head"},[s[5]||(s[5]=n("p",null,"历史草案",-1)),n("button",{type:"button",class:"history-close",onClick:ct},"关闭")]),x.value.length?(o(),a("div",Se,[(o(!0),a(S,null,C(x.value,e=>(o(),a("article",{key:e.id,class:"history-item"},[n("h4",null,u(e.title||"無題の案"),1),n("p",null,u(e.summary),1),n("div",Ce,[n("span",null,u(new Date(e.createdAt).toLocaleString("ja-JP",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})),1),n("div",Te,[n("button",{type:"button",onClick:p=>Dt(e)},"查看",8,Ae),n("button",{type:"button",onClick:p=>Nt(e.raw)},"送到表单",8,$e)])])]))),128))])):(o(),a("div",_e,"まだ保存された履歴がありません"))])):d("",!0),n("div",{class:"chat-log",ref_key:"chatLogRef",ref:Y},[(o(!0),a(S,null,C(T.value,e=>{var p,m,D,A,O,R,E;return o(),a("div",{key:e.id,class:oe(["chat-bubble",e.role==="user"?"chat-bubble--user":"chat-bubble--assistant"])},[e.type==="text"?(o(),a("div",Pe,[n("p",Ee,u(e.content),1),e.action==="direct-form"?(o(),a("button",{key:0,type:"button",class:"chat-inline-link",onClick:s[0]||(s[0]=l=>H(!1))}," 直接配置表单 ")):d("",!0),(p=e.options)!=null&&p.length?(o(),a("div",Le,[s[6]||(s[6]=n("p",{class:"chat-options-title"},"当前需要回答的核心问题",-1)),n("p",xe,u(e.options[0]),1),e.options.length>1?(o(),a("p",Ie," 还有其他问题，将在你回答完这一条后继续提出。 ")):d("",!0)])):d("",!0),(m=e.thinkingSteps)!=null&&m.length?(o(),a("div",Ne,[s[7]||(s[7]=n("p",{class:"thinking-inline-title"},"AI 思考过程",-1)),n("ol",null,[(o(!0),a(S,null,C(e.thinkingSteps,(l,w)=>(o(),a("li",{key:`${e.id}-thinking-${w}`},[n("span",De,u(w+1),1),n("span",Oe,u(l),1)]))),128))])])):d("",!0),(D=e.coachPrompts)!=null&&D.length?(o(),a("div",Re,[s[8]||(s[8]=n("p",{class:"coach-prompts-title"},"下一步灵感（Coach）",-1)),n("ol",null,[(o(!0),a(S,null,C(e.coachPrompts,(l,w)=>(o(),a("li",{key:`${e.id}-coach-${w}`},u(l),1))),128))])])):d("",!0),(A=e.editorChecklist)!=null&&A.length?(o(),a("div",qe,[s[10]||(s[10]=n("p",{class:"editor-checklist-title"},"需要补充/确认（Editor）",-1)),n("ul",null,[(o(!0),a(S,null,C(e.editorChecklist,(l,w)=>(o(),a("li",{key:`${e.id}-editor-${w}`},[n("label",null,[s[9]||(s[9]=n("input",{type:"checkbox",disabled:""},null,-1)),n("span",null,u(l),1)])]))),128))])])):d("",!0),e.writerSummary?(o(),a("div",ze,[s[17]||(s[17]=n("p",{class:"writer-summary-title"},"草稿摘要（Writer）",-1)),n("div",Fe,[e.writerSummary.headline?(o(),a("p",Me,[s[11]||(s[11]=n("strong",null,"标题",-1)),_(u(e.writerSummary.headline),1)])):d("",!0),e.writerSummary.audience?(o(),a("p",je,[s[12]||(s[12]=n("strong",null,"受众",-1)),_(u(e.writerSummary.audience),1)])):d("",!0),e.writerSummary.logistics?(o(),a("p",Ve,[s[13]||(s[13]=n("strong",null,"细节",-1)),_(u(e.writerSummary.logistics),1)])):d("",!0),e.writerSummary.riskNotes?(o(),a("p",Ue,[s[14]||(s[14]=n("strong",null,"风险",-1)),_(u(e.writerSummary.riskNotes),1)])):d("",!0),e.writerSummary.nextSteps?(o(),a("p",Je,[s[15]||(s[15]=n("strong",null,"下一步",-1)),_(u(e.writerSummary.nextSteps),1)])):d("",!0)]),(O=e.confirmQuestions)!=null&&O.length?(o(),a("div",Be,[s[16]||(s[16]=n("p",{class:"writer-confirm-label"},"请确认：",-1)),n("ul",null,[(o(!0),a(S,null,C(e.confirmQuestions,(l,w)=>(o(),a("li",{key:`${e.id}-confirm-${w}`},u(l),1))),128))])])):d("",!0)])):d("",!0)])):(o(),a("div",Qe,[n("p",Ge,u((R=e.payload)==null?void 0:R.title),1),n("p",He,u((E=e.payload)==null?void 0:E.description),1)])),n("span",Ye,u(e.createdAt),1)],2)}),128))],512),J.value?(o(),a("div",Ke,[...s[18]||(s[18]=[n("span",{class:"thinking-spinner"},null,-1),n("p",null,"AI 正在思考...",-1)])])):d("",!0),F.value?(o(),a("div",We,u(F.value),1)):d("",!0)]),r.value?(o(),a("section",Ze,[n("header",null,[s[20]||(s[20]=n("p",{class:"final-plan-label"},"AI 活动方案",-1)),n("p",Xe,u(wt.value),1)]),g(r.value.description)?(o(),a("div",ts,[s[21]||(s[21]=n("p",{class:"final-plan-subtitle"},"活动亮点",-1)),n("p",es,u(g(r.value.description)),1)])):d("",!0),n("div",ss,[r.value.notes&&g(r.value.notes)?(o(),a("article",ns,[s[22]||(s[22]=n("p",{class:"final-plan-subtitle"},"备注/准备",-1)),n("p",is,u(g(r.value.notes)),1)])):d("",!0),r.value.riskNotice&&g(r.value.riskNotice)?(o(),a("article",as,[s[23]||(s[23]=n("p",{class:"final-plan-subtitle"},"风险提示",-1)),n("p",os,u(g(r.value.riskNotice)),1)])):d("",!0)]),st.value.length?(o(),a("div",ls,[s[24]||(s[24]=n("p",{class:"final-plan-subtitle"},"时间 & 地点",-1)),n("ul",rs,[(o(!0),a(S,null,C(st.value,e=>(o(),a("li",{key:`logistics-${e.label}`},[n("strong",null,u(e.label)+"：",1),_(u(e.value),1)]))),128))])])):d("",!0),nt.value.length?(o(),a("div",us,[s[25]||(s[25]=n("p",{class:"final-plan-subtitle"},"票务设置",-1)),n("ul",cs,[(o(!0),a(S,null,C(nt.value,(e,p)=>(o(),a("li",{key:`ticket-${p}`,class:"final-plan-ticket"},[n("span",null,u(e.name),1),n("span",null,u(_t(e.price)),1)]))),128))])])):d("",!0),it.value.length?(o(),a("div",ps,[s[26]||(s[26]=n("p",{class:"final-plan-subtitle"},"参加要求",-1)),n("ul",ds,[(o(!0),a(S,null,C(it.value,(e,p)=>(o(),a("li",{key:`req-${p}`},u(e.label)+u(e.type==="must"?"（必需）":""),1))),128))])])):d("",!0),at.value.length?(o(),a("div",vs,[s[27]||(s[27]=n("p",{class:"final-plan-subtitle"},"报名表字段",-1)),n("ul",ys,[(o(!0),a(S,null,C(at.value,(e,p)=>(o(),a("li",{key:`form-${p}`},u(e.label)+" · "+u(e.type)+u(e.required?"（必填）":""),1))),128))])])):d("",!0)])):d("",!0),n("div",hs,[n("div",fs,[Yt(n("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>L.value=e),class:"chat-input",type:"text",placeholder:Ct.value,onKeyup:Wt(rt,["enter"])},null,40,gs),[[Kt,L.value]]),s[29]||(s[29]=n("button",{class:"chat-voice",type:"button"},[n("span",{class:"chat-button-label"},"语音")],-1)),n("button",{class:"chat-send",type:"button",onClick:rt,disabled:!L.value.trim()},[...s[28]||(s[28]=[n("span",{class:"chat-button-label"},"发送",-1)])],8,ms)]),r.value?(o(),a("section",ks,[n("button",{class:"primary gradient",type:"button",disabled:!y.value,onClick:s[2]||(s[2]=e=>H(!0))}," 送到表单 ",8,bs),n("button",{class:"primary",type:"button",onClick:s[3]||(s[3]=e=>It(r.value))},"保存草案")])):d("",!0)])],4))}}),Ts=re(ws,[["__scopeId","data-v-2f5d0de5"]]);export{Ts as default};
