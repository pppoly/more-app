import{d as g,a7 as h,r as c,c as d,o as w,e as v,i as e,j as y,t as n,z as k,a9 as I,ao as S,f as m,_ as x}from"./index-D9GuT0xz.js";const A={class:"payout"},B={class:"hero"},E={class:"sub"},M={key:0,class:"card"},O={class:"row"},z={class:"status-block"},D=["disabled"],N={key:1,class:"error"},P=g({__name:"PayoutSettingsMobile",setup(T){const i=h(),a=c(null),r=c(!1),o=c(null),u=d(()=>{var t,s;return!!((t=a.value)!=null&&t.stripeAccountId&&((s=a.value)!=null&&s.stripeAccountOnboarded))}),_=d(()=>u.value?"可以收钱啦":"先把收款开一下"),f=d(()=>u.value?"资料有变可以随时更新，保证打款顺利。":"按提示填资料，很快就能把票款结算到你账户。"),b=async()=>{o.value=null,i.activeCommunityId.value||(await i.loadCommunities(),i.ensureActiveCommunity());const t=i.activeCommunityId.value;if(!t){o.value="未找到可管理的社群";return}try{a.value=await I(t)}catch(s){o.value=s instanceof Error?s.message:"收款信息获取失败"}},C=async()=>{var t,s,p;if((t=a.value)!=null&&t.id){r.value=!0,o.value=null;try{const{url:l}=await S(a.value.id);window.location.href=l}catch(l){o.value=((p=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:p.message)||(l instanceof Error?l.message:"收款链接生成失败")}finally{r.value=!1}}};return w(b),(t,s)=>(m(),v("div",A,[e("header",B,[e("div",null,[s[0]||(s[0]=e("p",{class:"eyebrow"},"收银台",-1)),e("h1",null,n(_.value),1),e("p",E,n(f.value),1)]),e("span",{class:k(["pill",u.value?"ok":"warn"])},n(u.value?"可收款":"待开通"),3)]),a.value?(m(),v("section",M,[e("div",O,[e("div",null,[s[1]||(s[1]=e("p",{class:"label"},"账户状态",-1)),e("h3",null,n(u.value?"可以收钱啦":"还没开通"),1),s[2]||(s[2]=e("p",{class:"muted"},"先把收款开好，活动收入才能打进来。",-1))]),e("div",z,[s[3]||(s[3]=e("p",{class:"small"},"账户 ID",-1)),e("strong",null,n(a.value.stripeAccountId||"未创建"),1)])]),e("button",{class:"primary",disabled:r.value,onClick:C},n(r.value?"跳转中…":u.value?"更新收款信息":"去开通收款"),9,D),s[4]||(s[4]=e("p",{class:"hint"},"会跳到 Stripe 填信息，回来后就能继续用了。",-1))])):y("",!0),o.value?(m(),v("p",N,n(o.value),1)):y("",!0)]))}}),j=x(P,[["__scopeId","data-v-c9533979"]]);export{j as default};
