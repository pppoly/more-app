import{ad as Xt,d as te,a6 as ee,c as b,A as se,r as v,B as ie,C as tt,o as ne,a0 as oe,b as o,h as i,i as p,t as u,j as _,w as ae,F as T,f as A,v as bt,x as le,ae as re,n as ue,a8 as ce,g as pe,af as de,ag as ve,ah as ye,ai as he,aj as wt,u as fe,a4 as ge,e as a,y as _t,ak as me,_ as ke}from"./index-CT-XDF2b.js";const Tt=["title","description","startTime","locationText","ticketTypes","visibility","registrationFormSchema"],be=`${Xt}

---
You are the SOCIALMORE Event Creation Assistant.
- Mission: understand the organizer's intention, encourage them when they hesitate, and then help them commit to clear written decisions.
- Persona: warm coach at first, precise editor later. Never turn the conversation into a rigid form.
- Languages: default to Japanese, but mirror the user's input language when possible.
- Process: Listen (感性) → Guide (構造化) → Write (草稿を提示) → Confirm (ユーザーに最終判断を委ねる).`,we={coach:`Current stage: 感性モード (Coach).
Goals:
- Surface the organizer's motivation, people they want to help, and desired vibe.
- Translate vague wishes into tangible goals.
- Ask one focused question at a time; do not rush into fields or checklists.
Forbidden:
- Empty hype (e.g., "必ず成功します").
- Ignoring obvious fears or blockers the organizer mentions.`,editor:`Current stage: 理性モード (Editor).
Goals:
- Organize concrete decisions (title, time, location, ticketing, requirements).
- Offer options with pros/cons when the organizer hesitates.
- Highlight contradictions or risks (e.g., "想要開放但又限定費用很高").
Guidelines:
- Provide concise bullet structures or A/B drafts.
- Ask clarifying questions only for the missing fields listed below.`,writer:`Current stage: ライティング / 確認.
Goals:
- Summarize the EventDraft so the organizer can confirm or adjust.
- Clearly list every key field (title, schedule, ticketing, requirements, notes).
- Invite the organizer to edit specific parts instead of rewriting everything.
If something is still missing, politely mention it before presenting the summary.`},_e='Reply with:\n1) A short natural-language response following the current stage instructions.\n2) If you update the draft, append a JSON block using ```json ... ``` that contains { "type": "event_draft_update", "data": Partial<EventDraft> }.\nNever invent data that the organizer has not provided.';function Se(n){if(!n)return"coach";const y=!!(typeof n.title=="string"&&n.title.trim()||n.purpose||n.description||n.category||n.targetAudience),S=Tt.every(g=>{const h=n[g];return h==null?!1:Array.isArray(h)?h.length>0:typeof h=="string"?h.trim().length>0:!0});return y?S?"writer":"editor":"coach"}function Ce(n){var S;if(!n)return"No draft data yet.";const y=[];if(n.title&&y.push(`Title: ${J(n.title)}`),n.subtitle&&y.push(`Subtitle: ${J(n.subtitle)}`),n.purpose&&y.push(`Purpose: ${J(n.purpose)}`),n.description&&y.push(`Description: ${J(n.description)}`),n.startTime&&y.push(`Start: ${n.startTime}`),n.endTime&&y.push(`End: ${n.endTime}`),n.locationText&&y.push(`Location: ${n.locationText}`),n.ticketTypes&&n.ticketTypes.length){const g=n.ticketTypes.map(h=>`${J(h.name)} ¥${h.price??0}`).join(", ");y.push(`Ticketing: ${g}`)}return n.requirements&&n.requirements.length&&y.push(`Requirements: ${n.requirements.map(g=>g.label).join(", ")}`),(S=n.config)!=null&&S.riskNoticeEnabled&&y.push("Risk notice is enabled."),y.length?y.join(`
`):"Draft exists but has no descriptive fields yet."}function J(n){return n==null?"":typeof n=="string"?n:typeof n=="object"&&"original"in n?String(n.original??""):JSON.stringify(n)}function Te(n){if(!n)return"All fields missing.";const y=Tt.filter(S=>{const g=n[S];return g==null?!0:Array.isArray(g)?g.length===0:typeof g=="string"?g.trim().length===0:!1});return y.length?`Fields still missing: ${y.join(", ")}`:"Required fields are present."}function Ae(n){const y=n.explicitStage??Se(n.draft),S=n.locale==="zh"?"回答は簡体字中文でもよいですが、ユーザーの入力言語に合わせてください。":n.locale==="en"?"Respond in English unless the organizer prefers Japanese.":"回答は日本語をベースに、ユーザーの言語に合わせてカスタマイズしてください。",g=[n.userName?`Organizer: ${n.userName}`:null,n.communityName?`Community: ${n.communityName}`:null,n.lastUserUtterance?`Latest user message: ${n.lastUserUtterance}`:null].filter(Boolean).join(`
`),h=[be,S,we[y],`Draft context:
${Ce(n.draft)}`,Te(n.draft),_e].concat(g?[`
Context:
${g}`]:[]).join(`

`);return{stage:y,prompt:h}}const $e={class:"assistant-chat-surface"},Pe={class:"chat-tools"},Ie={class:"status-chip"},Ee={class:"mode-chip"},Le={key:0,class:"prompt-chip"},xe={key:0,class:"assistant-guide"},Ne={class:"history-sheet"},De={key:0,class:"history-empty"},Oe={key:1,class:"history-list"},Re=["onClick"],qe={class:"history-item-body"},Fe={class:"history-item-time"},ze={key:2,class:"history-preview"},Me={class:"history-preview-summary"},je={key:0,class:"history-preview-desc"},Ve={class:"history-preview-actions"},Je={key:0,class:"chat-text-block"},Ue={class:"chat-text"},Ge={key:1,class:"chat-options"},Be={class:"chat-options-question"},Qe={key:0,class:"chat-options-note"},He={key:2,class:"thinking-collapsible"},Ke=["onClick"],We={class:"thinking-toggle__action"},Ye={class:"thinking-inline"},Ze={class:"thinking-inline-index"},Xe={class:"thinking-inline-text"},ts={key:3,class:"coach-prompts"},es={key:4,class:"editor-checklist"},ss={key:5,class:"writer-summary"},is={class:"writer-summary-grid"},ns={key:0},os={key:1},as={key:2},ls={key:3},rs={key:4},us={key:0,class:"writer-confirm"},cs={key:1,class:"proposal-card"},ps={class:"proposal-title"},ds={class:"proposal-desc"},vs={class:"chat-meta"},ys={key:3,class:"thinking-banner"},hs={key:4,class:"assistant-error"},fs={key:0,class:"final-plan-card"},gs={class:"final-plan-title"},ms={key:0,class:"final-plan-section"},ks={class:"final-plan-text"},bs={class:"final-plan-grid"},ws={key:0},_s={class:"final-plan-text"},Ss={key:1},Cs={class:"final-plan-text"},Ts={key:1,class:"final-plan-section"},As={class:"final-plan-list"},$s={key:2,class:"final-plan-section"},Ps={class:"final-plan-ticket-list"},Is={key:3,class:"final-plan-section"},Es={class:"final-plan-list"},Ls={key:4,class:"final-plan-section"},xs={class:"final-plan-list"},Ns={class:"assistant-bottom"},Ds={class:"chat-input-row"},Os=["placeholder"],Rs=["disabled"],qs={key:0,class:"final-plan-actions"},Fs=["disabled"],St="console-ai-assistant-history",Ct="console-ai-assistant-drafts",zs=te({__name:"ConsoleEventAssistantMobile",setup(n){const y=se(),S=fe(),g=ee(),h=b(()=>y.params.communityId);b(()=>{const e=h.value;if(!e)return"";const t=g.communities.value.find(s=>s.id===e);return(t==null?void 0:t.name)??""});const U=v(null),M=v(!1),c=ie({baseLanguage:"ja",topic:"",audience:"",style:"",details:""}),G=[{key:"topic",prompt:"どんなイベントを企画していますか？（例：親子BBQ、言語交換など）"},{key:"audience",prompt:"主な対象や届けたい人は誰ですか？"},{key:"style",prompt:"雰囲気やスタイルはどうしたいですか？（family-friendly / casual など）"},{key:"details",prompt:"場所・所要時間・持ち物など、補足したいことを自由にどうぞ。"}],w=v([]),et=v(null),K=v(0),At=b(()=>({"--keyboard-offset":`${K.value}px`})),N=v(""),st=v(null),B=v(!1),j=v(null),r=v(null),V=v(0),it=v(!1),P=v([]),k=v(null),I=v(!1),Q=v(!0),H=v(null),nt=v("collecting"),W=v("coach-v2"),Y=v("coach"),E=v(null),$t={coach:"模式：Coach（点火）",editor:"模式：Editor（打灯）",writer:"模式：Writer（草稿确认）"},Pt=v(0),It=v("ja"),Et=b(()=>{switch(nt.value){case"ready":return"方案已生成";case"options":return"候选提案";default:return"信息收集中"}}),D=v({baseLanguage:"zh",topic:"コミュニティイベント",audience:"地域の仲間",style:"family-friendly"}),ot=b(()=>{var e;for(let t=w.value.length-1;t>=0;t-=1){const s=w.value[t];if(s.role==="assistant"&&((e=s.coachPrompts)!=null&&e.length))return s.coachPrompts}return[]}),at=v([]),lt=v([]),Lt=b(()=>r.value?m(r.value.title)||c.topic||"AI 提案":""),rt=b(()=>{var s;const e=(s=r.value)==null?void 0:s.logistics;if(!e)return[];const t=[];return e.startTime&&t.push({label:"开始时间",value:formatDateTime(e.startTime)}),e.endTime&&t.push({label:"结束时间",value:formatDateTime(e.endTime)}),e.locationText&&t.push({label:"地点",value:e.locationText}),e.locationNote&&t.push({label:"地点备注",value:e.locationNote}),t}),ut=b(()=>{var e;return((e=r.value)==null?void 0:e.ticketTypes)??[]}),ct=b(()=>{var e;return((e=r.value)==null?void 0:e.requirements)??[]}),pt=b(()=>{var e;return((e=r.value)==null?void 0:e.registrationForm)??[]}),xt=e=>e==null?"免费":`¥${e.toLocaleString("ja-JP")}`,Nt=b(()=>({title:c.topic||"",description:c.details||c.topic,targetAudience:c.audience,vibe:c.style,locationText:c.details,ticketTypes:[],registrationFormSchema:[]})),Dt=b(()=>Q.value),Ot=b(()=>E.value?E.value:ot.value.length?ot.value[0]:V.value>=G.length?"追加で伝えたいことや質問を入力してください":G[V.value].prompt);tt(()=>h.value,()=>{M.value=!1,vt()}),tt(()=>w.value.length,(e,t)=>{t===0&&e>0&&(Q.value=!1)}),tt(()=>I.value,e=>{e?k.value=P.value[0]??null:k.value=null});const dt=()=>{ge(()=>{const e=et.value;e&&(e.scrollTop=e.scrollHeight)})},O=(e,t,s,d,f,R,$,q,F,x,l)=>{w.value.push({id:`${Date.now()}-${Math.random().toString(36).slice(2)}`,role:e,type:t,content:s,createdAt:new Date().toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"}),payload:d,action:f,options:R,thinkingSteps:$&&$.length?$:void 0,coachPrompts:q,editorChecklist:F,writerSummary:x,confirmQuestions:l}),w.value.length>200&&w.value.shift(),dt()},vt=async()=>{if(!h.value){U.value=null,M.value=!1,await yt();return}try{U.value=await ce(h.value)}catch(e){console.warn("Failed to load community detail",e),U.value=null}finally{M.value=!1,await yt()}},yt=async()=>{if(M.value)return;M.value=!0;const e=U.value,t=e!=null&&e.description?pe(e.description):"",s=(e==null?void 0:e.name)??"Tokyo Community Organizations Meetup Group",d=t?`コミュニティ紹介：${s}
${t}

上記の背景を踏まえて、主催者が最初のアイデアを話しやすいようCoachモードで歓迎し、最初の質問を投げかけてください。`:"コミュニティ紹介情報はありません。主催者を歓迎し、最初のアイデアを引き出す質問から始めてください。";await ft(d,{overrideSummary:`コミュニティ紹介: ${s}`})},ht=async(e="button")=>{var s;if(!N.value.trim()||B.value)return;const t=N.value.trim();N.value="",e==="button"&&((s=st.value)==null||s.blur(),K.value=0),O("user","text",t),await Ft(t)},Rt=e=>/[\u4e00-\u9fff]/.test(e)?"zh":/[a-zA-Z]/.test(e)?"en":"ja",qt=e=>{const t=Rt(e);t&&c.baseLanguage!==t&&(c.baseLanguage=t)},Ft=async e=>{qt(e);const t=G[V.value];t&&(c[t.key]=e),V.value<G.length-1&&(V.value+=1),E.value=null,await ft(e)},ft=async(e,t)=>{var x;j.value=null;const s=(t==null?void 0:t.overrideSummary)??mt(e),{stage:d,prompt:f}=Ae({draft:Nt.value,locale:c.baseLanguage||"ja",lastUserUtterance:e});Y.value=d;const R=Kt(),$=`${s}

--- Conversation ---
${R}

--- Assistant Prompt ---
${f}`,q=Wt(),F={baseLanguage:L(c.baseLanguage,"baseLanguage"),topic:L(c.topic,"topic"),audience:L(c.audience,"audience"),style:L(c.style,"style"),details:$,conversation:q};B.value=!0;try{const l=await de(F),C=Array.isArray(l.thinkingSteps)?l.thinkingSteps:[];nt.value=l.status,W.value=l.promptVersion,Pt.value=l.turnCount,It.value=l.language,l.stage&&["coach","editor","writer"].includes(l.stage)&&(Y.value=l.stage),at.value=l.editorChecklist??[],lt.value=l.confirmQuestions??[];const kt=l.stage==="writer";O("assistant","text",l.message,void 0,void 0,l.options,C,l.coachPrompts,l.editorChecklist,kt?l.writerSummary:void 0,l.confirmQuestions),E.value=((x=l.options)==null?void 0:x[0])??null;let z=null;if((l.status==="ready"||l.status==="options"||!!l.proposal)&&l.stage==="writer"){z={...l.proposal??await ve({baseLanguage:c.baseLanguage||"ja",topic:c.topic||"コミュニティイベント",audience:c.audience||"地域の仲間",style:c.style||"family-friendly",details:s}),summary:s},r.value=z;const Yt=m(z.title),Zt=m(z.description);O("assistant","proposal","",{title:Yt,description:Zt,raw:r.value})}else r.value=null,E.value=null;await zt(d,s,{status:l.status,promptVersion:l.promptVersion,turnCount:l.turnCount,language:l.language,options:l.options??[],coachPrompts:l.coachPrompts??[],editorChecklist:l.editorChecklist??[],writerSummary:kt?l.writerSummary??null:null}),z&&Mt(z)}catch(l){j.value=l instanceof Error?l.message:"AI生成に失敗しました。少し時間を置いて再度お試しください。",O("assistant","text",j.value??"AI生成に失敗しました。")}finally{B.value=!1,E.value||(E.value=null)}},zt=async(e,t,s)=>{if(h.value)try{it.value=!0;const d=w.value.map(f=>({id:f.id,role:f.role,type:f.type,content:f.content,createdAt:f.createdAt,payload:f.payload?{title:f.payload.title??null,description:f.payload.description??null}:null}));await ye(h.value,{stage:e,summary:t,qaState:JSON.parse(JSON.stringify(c)),messages:d,aiResult:r.value?{title:r.value.title,description:r.value.description,notes:r.value.notes,riskNotice:r.value.riskNotice}:null,promptVersion:s==null?void 0:s.promptVersion,status:s==null?void 0:s.status,turnCount:s==null?void 0:s.turnCount,language:s==null?void 0:s.language,meta:{options:(s==null?void 0:s.options)??[],coachPrompts:(s==null?void 0:s.coachPrompts)??[],editorChecklist:(s==null?void 0:s.editorChecklist)??[],writerSummary:(s==null?void 0:s.writerSummary)??null}})}catch(d){console.warn("Failed to save assistant log",d)}finally{it.value=!1}},Mt=e=>{const t={id:`${Date.now()}-${Math.random().toString(36).slice(2)}`,createdAt:Date.now(),summary:e.summary,title:m(e.title),description:m(e.description),raw:e};P.value=[t,...P.value].slice(0,10),localStorage.setItem(St,JSON.stringify(P.value))},jt=()=>{const e=localStorage.getItem(St);if(e)try{const t=JSON.parse(e);P.value=t}catch(t){console.warn("Failed to parse assistant history",t)}},Vt=e=>{if(!e)return;const t=localStorage.getItem(Ct);let s=[];if(t)try{s=JSON.parse(t)}catch{s=[]}s=[{id:`${Date.now()}-${Math.random().toString(36).slice(2)}`,createdAt:Date.now(),summary:e.summary||"",title:m(e.title),description:m(e.description),raw:e},...s].slice(0,10),localStorage.setItem(Ct,JSON.stringify(s)),O("assistant","text","この案を草稿として保存しました。履歴からいつでも復元できます。")},Jt=e=>{e&&(r.value={...e,summary:e.summary||mt()},X(!0),I.value=!1,k.value=null)},Ut=e=>{k.value=e},Gt=e=>{e&&(r.value={...e.raw,summary:e.summary},O("assistant","proposal","",{title:e.title,description:e.description,raw:r.value}),I.value=!1,k.value=null,dt())},Z=()=>{I.value=!I.value,I.value||(k.value=null)},gt=()=>{Q.value=!Q.value},Bt=e=>{H.value=H.value===e?null:e},Qt=async()=>{try{const e=await he();D.value=e.defaults,W.value=e.version,Ht()}catch(e){console.warn("Failed to load assistant defaults",e)}},Ht=()=>{c.baseLanguage||(c.baseLanguage=D.value.baseLanguage),c.topic||(c.topic=D.value.topic),c.audience||(c.audience=D.value.audience),c.style||(c.style=D.value.style)},mt=e=>`AIの理解：対象は「${L(c.audience,"audience")}」、イベントは「${L(c.topic,"topic")}」、雰囲気は「${L(c.style,"style")}」。補足情報: ${e||c.details||"特記事項なし"}`,Kt=()=>w.value.slice(-8).map(e=>{var d,f;const t=e.role==="user"?"User":"Assistant",s=e.type==="text"?e.content:`提案: ${((d=e.payload)==null?void 0:d.title)??""} ${((f=e.payload)==null?void 0:f.description)??""}`;return`${t}: ${s}`}).join(`
`),Wt=()=>w.value.slice(-10).map(e=>{var t,s;return{role:e.role,content:e.type==="text"?e.content:`提案: ${((t=e.payload)==null?void 0:t.title)??""} ${((s=e.payload)==null?void 0:s.description)??""}`}}),L=(e,t)=>e&&e.trim()?e:D.value[t],m=e=>e?typeof e=="string"?e:typeof e=="object"&&e.original?e.original:"":"",X=e=>{h.value&&(e&&r.value?sessionStorage.setItem(wt,JSON.stringify({title:m(r.value.title),subtitle:m(r.value.subtitle),description:m(r.value.description),notes:m(r.value.notes),riskNotice:m(r.value.riskNotice),logistics:r.value.logistics??null,ticketTypes:r.value.ticketTypes??[],requirements:r.value.requirements??[],registrationForm:r.value.registrationForm??[],visibility:r.value.visibility??"public",checklist:at.value,confirmQuestions:lt.value,generatedAt:Date.now()})):sessionStorage.removeItem(wt),window.alert("AI案をフォームに送信します。次の画面で各項目を確認してください。"),S.push({name:"ConsoleMobileEventForm",params:{communityId:h.value},query:{source:"ai-assistant"}}))};return ne(async()=>{if(await Qt(),await g.loadCommunities(),h.value&&g.setActiveCommunity(h.value),jt(),await vt(),typeof window<"u"&&window.visualViewport){const e=()=>{const t=window.visualViewport,s=window.innerHeight,d=Math.max(0,s-t.height-t.offsetTop);K.value=d};window.visualViewport.addEventListener("resize",e),window.visualViewport.addEventListener("scroll",e),e(),oe(()=>{var t,s;(t=window.visualViewport)==null||t.removeEventListener("resize",e),(s=window.visualViewport)==null||s.removeEventListener("scroll",e)})}}),(e,t)=>(a(),o("div",{class:"assistant-screen",style:ue(At.value)},[i("section",$e,[i("div",Pe,[i("span",Ie,u(Et.value),1),i("span",Ee,u($t[Y.value]),1),r.value?(a(),o("span",Le,"Prompt "+u(W.value),1)):p("",!0),i("button",{type:"button",class:"history-toggle",onClick:Z},[t[8]||(t[8]=i("span",{class:"i-lucide-clock-4"},null,-1)),_(" "+u(k.value?"收起历史":"会话历史"),1)])]),Dt.value?(a(),o("section",xe,[t[9]||(t[9]=i("p",{class:"guide-title"},"SOCIALMORE AI 使用说明",-1)),t[10]||(t[10]=i("ol",null,[i("li",null,[i("strong",null,"Speak"),_("：随便说出你的想法或需求。")]),i("li",null,[i("strong",null,"Guide"),_("：AI Coach/Editor 会提问，逐条回答即可。")]),i("li",null,[i("strong",null,"Write"),_("：完成提问后，AI 会生成方案，并可一键送表单或存草案。")])],-1)),w.value.length?(a(),o("button",{key:0,type:"button",class:"guide-dismiss",onClick:gt}," 收起说明 ")):p("",!0)])):(a(),o("button",{key:1,type:"button",class:"guide-inline-toggle",onClick:gt},[...t[11]||(t[11]=[i("span",{class:"i-lucide-info"},null,-1),_(" 查看使用说明 ",-1)])])),I.value?(a(),o("div",{key:2,class:"history-overlay",onClick:ae(Z,["self"])},[i("section",Ne,[i("header",{class:"history-head"},[t[12]||(t[12]=i("div",null,[i("p",{class:"history-title"},"历史草案"),i("p",{class:"history-subtitle"},"最近 10 条保存的 AI 方案")],-1)),i("button",{type:"button",class:"history-close",onClick:Z},"关闭")]),P.value.length?(a(),o("div",Oe,[(a(!0),o(T,null,A(P.value,s=>{var d;return a(),o("article",{key:s.id,class:_t(["history-item",((d=k.value)==null?void 0:d.id)===s.id?"is-active":""]),onClick:f=>Ut(s)},[i("div",qe,[i("h4",null,u(s.title||"無題の案"),1),i("p",null,u(s.summary),1)]),i("span",Fe,u(new Date(s.createdAt).toLocaleString("ja-JP",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})),1)],10,Re)}),128))])):(a(),o("div",De,"まだ保存された履歴がありません")),k.value?(a(),o("div",ze,[i("h4",null,u(k.value.title||"無題の案"),1),i("p",Me,u(k.value.summary||"暂无摘要"),1),k.value.description?(a(),o("p",je,u(k.value.description),1)):p("",!0),t[13]||(t[13]=i("p",{class:"history-preview-note"},"载入将把该草案插入当前对话；送到表单则直接打开活动编辑页并填入 AI 提案。",-1)),i("div",Ve,[i("button",{type:"button",class:"primary ghost",onClick:t[0]||(t[0]=s=>Gt(k.value))}," 载入到对话 "),i("button",{type:"button",class:"primary gradient",onClick:t[1]||(t[1]=s=>Jt(k.value.raw))}," 送到表单 ")])])):p("",!0)])])):p("",!0),i("div",{class:"chat-log",ref_key:"chatLogRef",ref:et},[(a(!0),o(T,null,A(w.value,s=>{var d,f,R,$,q,F,x;return a(),o("div",{key:s.id,class:_t(["chat-bubble",s.role==="user"?"chat-bubble--user":"chat-bubble--assistant"])},[s.type==="text"?(a(),o("div",Je,[i("p",Ue,u(s.content),1),s.action==="direct-form"?(a(),o("button",{key:0,type:"button",class:"chat-inline-link",onClick:t[2]||(t[2]=l=>X(!1))}," 直接配置表单 ")):p("",!0),(d=s.options)!=null&&d.length?(a(),o("div",Ge,[t[14]||(t[14]=i("p",{class:"chat-options-title"},"当前需要回答的核心问题",-1)),i("p",Be,u(s.options[0]),1),s.options.length>1?(a(),o("p",Qe," 还有其他问题，将在你回答完这一条后继续提出。 ")):p("",!0)])):p("",!0),(f=s.thinkingSteps)!=null&&f.length?(a(),o("div",He,[i("button",{type:"button",class:"thinking-toggle",onClick:l=>Bt(s.id)},[t[15]||(t[15]=i("span",null,"AI 思考过程",-1)),i("span",We,u(H.value===s.id?"收起":"展开"),1)],8,Ke),bt(i("div",Ye,[t[16]||(t[16]=i("p",{class:"thinking-inline-title"},"AI 思考过程",-1)),i("ol",null,[(a(!0),o(T,null,A(s.thinkingSteps,(l,C)=>(a(),o("li",{key:`${s.id}-thinking-${C}`},[i("span",Ze,u(C+1),1),i("span",Xe,u(l),1)]))),128))])],512),[[me,H.value===s.id]])])):p("",!0),(R=s.coachPrompts)!=null&&R.length?(a(),o("div",ts,[t[17]||(t[17]=i("p",{class:"coach-prompts-title"},"下一步灵感（Coach）",-1)),i("ol",null,[(a(!0),o(T,null,A(s.coachPrompts,(l,C)=>(a(),o("li",{key:`${s.id}-coach-${C}`},u(l),1))),128))])])):p("",!0),($=s.editorChecklist)!=null&&$.length?(a(),o("div",es,[t[19]||(t[19]=i("p",{class:"editor-checklist-title"},"需要补充/确认（Editor）",-1)),i("ul",null,[(a(!0),o(T,null,A(s.editorChecklist,(l,C)=>(a(),o("li",{key:`${s.id}-editor-${C}`},[i("label",null,[t[18]||(t[18]=i("input",{type:"checkbox",disabled:""},null,-1)),i("span",null,u(l),1)])]))),128))])])):p("",!0),s.writerSummary?(a(),o("div",ss,[t[26]||(t[26]=i("p",{class:"writer-summary-title"},"草稿摘要（Writer）",-1)),i("div",is,[s.writerSummary.headline?(a(),o("p",ns,[t[20]||(t[20]=i("strong",null,"标题",-1)),_(u(s.writerSummary.headline),1)])):p("",!0),s.writerSummary.audience?(a(),o("p",os,[t[21]||(t[21]=i("strong",null,"受众",-1)),_(u(s.writerSummary.audience),1)])):p("",!0),s.writerSummary.logistics?(a(),o("p",as,[t[22]||(t[22]=i("strong",null,"细节",-1)),_(u(s.writerSummary.logistics),1)])):p("",!0),s.writerSummary.riskNotes?(a(),o("p",ls,[t[23]||(t[23]=i("strong",null,"风险",-1)),_(u(s.writerSummary.riskNotes),1)])):p("",!0),s.writerSummary.nextSteps?(a(),o("p",rs,[t[24]||(t[24]=i("strong",null,"下一步",-1)),_(u(s.writerSummary.nextSteps),1)])):p("",!0)]),(q=s.confirmQuestions)!=null&&q.length?(a(),o("div",us,[t[25]||(t[25]=i("p",{class:"writer-confirm-label"},"请确认：",-1)),i("ul",null,[(a(!0),o(T,null,A(s.confirmQuestions,(l,C)=>(a(),o("li",{key:`${s.id}-confirm-${C}`},u(l),1))),128))])])):p("",!0)])):p("",!0)])):(a(),o("div",cs,[i("p",ps,u((F=s.payload)==null?void 0:F.title),1),i("p",ds,u((x=s.payload)==null?void 0:x.description),1)])),i("span",vs,u(s.createdAt),1)],2)}),128))],512),B.value?(a(),o("div",ys,[...t[27]||(t[27]=[i("span",{class:"thinking-spinner"},null,-1),i("p",null,"AI 正在思考...",-1)])])):p("",!0),j.value?(a(),o("div",hs,u(j.value),1)):p("",!0)]),r.value?(a(),o("section",fs,[i("header",null,[t[28]||(t[28]=i("p",{class:"final-plan-label"},"AI 活动方案",-1)),i("p",gs,u(Lt.value),1)]),m(r.value.description)?(a(),o("div",ms,[t[29]||(t[29]=i("p",{class:"final-plan-subtitle"},"活动亮点",-1)),i("p",ks,u(m(r.value.description)),1)])):p("",!0),i("div",bs,[r.value.notes&&m(r.value.notes)?(a(),o("article",ws,[t[30]||(t[30]=i("p",{class:"final-plan-subtitle"},"备注/准备",-1)),i("p",_s,u(m(r.value.notes)),1)])):p("",!0),r.value.riskNotice&&m(r.value.riskNotice)?(a(),o("article",Ss,[t[31]||(t[31]=i("p",{class:"final-plan-subtitle"},"风险提示",-1)),i("p",Cs,u(m(r.value.riskNotice)),1)])):p("",!0)]),rt.value.length?(a(),o("div",Ts,[t[32]||(t[32]=i("p",{class:"final-plan-subtitle"},"时间 & 地点",-1)),i("ul",As,[(a(!0),o(T,null,A(rt.value,s=>(a(),o("li",{key:`logistics-${s.label}`},[i("strong",null,u(s.label)+"：",1),_(u(s.value),1)]))),128))])])):p("",!0),ut.value.length?(a(),o("div",$s,[t[33]||(t[33]=i("p",{class:"final-plan-subtitle"},"票务设置",-1)),i("ul",Ps,[(a(!0),o(T,null,A(ut.value,(s,d)=>(a(),o("li",{key:`ticket-${d}`,class:"final-plan-ticket"},[i("span",null,u(s.name),1),i("span",null,u(xt(s.price)),1)]))),128))])])):p("",!0),ct.value.length?(a(),o("div",Is,[t[34]||(t[34]=i("p",{class:"final-plan-subtitle"},"参加要求",-1)),i("ul",Es,[(a(!0),o(T,null,A(ct.value,(s,d)=>(a(),o("li",{key:`req-${d}`},u(s.label)+u(s.type==="must"?"（必需）":""),1))),128))])])):p("",!0),pt.value.length?(a(),o("div",Ls,[t[35]||(t[35]=i("p",{class:"final-plan-subtitle"},"报名表字段",-1)),i("ul",xs,[(a(!0),o(T,null,A(pt.value,(s,d)=>(a(),o("li",{key:`form-${d}`},u(s.label)+" · "+u(s.type)+u(s.required?"（必填）":""),1))),128))])])):p("",!0)])):p("",!0),i("div",Ns,[i("div",Ds,[bt(i("input",{ref_key:"chatInputRef",ref:st,"onUpdate:modelValue":t[3]||(t[3]=s=>N.value=s),class:"chat-input",type:"text",placeholder:Ot.value,onKeyup:t[4]||(t[4]=re(s=>ht("enter"),["enter"]))},null,40,Os),[[le,N.value]]),t[37]||(t[37]=i("button",{class:"chat-voice",type:"button"},[i("span",{class:"chat-button-label"},"语音")],-1)),i("button",{class:"chat-send",type:"button",onClick:t[5]||(t[5]=s=>ht("button")),disabled:!N.value.trim()},[...t[36]||(t[36]=[i("span",{class:"chat-button-label"},"发送",-1)])],8,Rs)]),r.value?(a(),o("section",qs,[i("button",{class:"primary gradient",type:"button",disabled:!h.value,onClick:t[6]||(t[6]=s=>X(!0))}," 送到表单 ",8,Fs),i("button",{class:"primary",type:"button",onClick:t[7]||(t[7]=s=>Vt(r.value))},"保存草案")])):p("",!0)])],4))}}),Js=ke(zs,[["__scopeId","data-v-2057cf75"]]);export{Js as default};
