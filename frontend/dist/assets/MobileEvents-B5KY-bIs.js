import{d as G,u as H,r as m,c as I,a as g,g as K,o as Q,b as r,e as c,F as h,f,h as o,t as n,i as W,n as M,j as X,w as Y,k as Z,_ as tt}from"./index-BGcABSEi.js";const at={class:"mobile-events-page"},et={key:0,class:"state-section"},st={key:1,class:"state-section"},ot={class:"state-card state-card--error"},rt={class:"state-card__body"},ct={class:"state-card__message"},nt=["disabled"],it={key:2,class:"card-list"},lt={key:0,class:"state-empty"},ut=["onClick"],dt={class:"event-card__cover-meta"},mt={class:"event-card__avatar-stack"},pt=["src"],_t={class:"event-card__capacity-pill"},yt={class:"event-card__details"},gt={class:"event-card__title"},ht={class:"event-card__meta"},ft={class:"event-card__community-row"},vt=["onClick"],bt=["src"],kt={key:1},At={class:"event-card__community-name"},i="https://raw.githubusercontent.com/moreard/dev-assets/main/socialmore/default-avatar.png",wt=G({__name:"MobileEvents",setup(Ct){const v=H(),p=m([]),_=m(!0),l=m(null),u=m(!1),b=async()=>{_.value=!0,l.value=null;try{p.value=await Z()}catch(t){console.warn("fetchEvents failed",t),p.value=[],l.value="ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç’°å¢ƒã‚’ç¢ºèªã—ã¦å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚"}finally{_.value=!1}},$=async()=>{u.value=!0,await b(),u.value=!1},U=t=>{const e={parent:"è¦ªå­",sports:"ã‚¹ãƒãƒ¼ãƒ„",language:"èªžå­¦",work:"ã‚¹ã‚­ãƒ«",career:"ã‚­ãƒ£ãƒªã‚¢",kids:"ã‚­ãƒƒã‚º"},a=(t??"").toLowerCase();return e[a]??"ã‚¤ãƒ™ãƒ³ãƒˆ"},k=["https://images.unsplash.com/photo-1500534314209-a25ddb2bd429?auto=format&fit=crop&w=1200&q=80","https://images.unsplash.com/photo-1448932223592-d1fc686e76ea?auto=format&fit=crop&w=1200&q=80","https://images.unsplash.com/photo-1515168833906-d2a3b82b302a?auto=format&fit=crop&w=1200&q=80","https://images.unsplash.com/photo-1454496522488-7a8e488e8606?auto=format&fit=crop&w=1200&q=80","https://images.unsplash.com/photo-1529333166437-7750a6dd5a70?auto=format&fit=crop&w=1200&q=80","https://images.unsplash.com/photo-1521737604893-d14cc237f11d?auto=format&fit=crop&w=1200&q=80","https://images.unsplash.com/photo-1454165205744-3b78555e5572?auto=format&fit=crop&w=1200&q=80"],q=(t,e)=>{let a=0;for(let s=0;s<t.length;s+=1)a=(a<<5)-a+t.charCodeAt(s),a|=0;return Math.abs(a)%e},D=t=>{var a;if(t.coverImageUrl)return{backgroundImage:`url(${g(t.coverImageUrl)})`,backgroundPosition:"center",backgroundSize:"cover"};const e=q(t.id||((a=t.title)==null?void 0:a.toString())||"fallback",k.length);return{backgroundImage:`url(${k[e]})`,backgroundPosition:"center",backgroundSize:"cover"}},z=I(()=>p.value.filter(t=>t.status==="open")),A=I(()=>z.value.map(t=>{var x,T,S,L,E,P;const e=D(t),a=w(t),s=C(t),d=s&&s>0?Math.min(100,Math.round(a/s*100)):null;return{id:t.id,title:K(t.title),categoryLabel:U(t.category),dateText:R(t.startTime),timeText:j(t.startTime),locationText:t.locationText,communityName:((x=t.community)==null?void 0:x.name)??"SOCIALMORE",communitySlug:((T=t.community)==null?void 0:T.slug)??((S=t.community)==null?void 0:S.id)??"club",communityLogo:t.communityLogoUrl?g(t.communityLogoUrl):null,communityInitial:((P=(E=(L=t.community)==null?void 0:L.name)==null?void 0:E.charAt(0))==null?void 0:P.toUpperCase())??"M",statusLabel:F(t.status),statusClass:V(t.status),capacityText:J(t),capacityPercent:d,hasCover:!!t.coverImageUrl,coverStyle:e,attendees:O(t)}})),N=t=>{v.push({name:"event-detail",params:{eventId:t}})},B=t=>{t&&v.push({name:"community-portal",params:{slug:t}})},F=t=>t==="open"?"å‚åŠ å‹Ÿé›†ä¸­":t==="closed"?"å—ä»˜çµ‚äº†":"å‘ŠçŸ¥äºˆå®š",V=t=>t==="open"?"event-card__status--open":t==="closed"?"event-card__status--closed":"event-card__status--info",R=t=>{const e=new Date(t);return`${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getDate().toString().padStart(2,"0")}`},j=t=>new Date(t).toLocaleString("ja-JP",{month:"long",day:"numeric",weekday:"short",hour:"2-digit",minute:"2-digit"}),y=t=>t.config??{},w=t=>{const e=y(t);return typeof e.currentParticipants=="number"?e.currentParticipants:Array.isArray(e.participants)?e.participants.length:0},C=t=>{var a,s;const e=y(t);return typeof e.capacity=="number"?e.capacity:typeof t.maxParticipants=="number"?t.maxParticipants:Array.isArray(t.ticketTypes)&&((a=t.ticketTypes[0])==null?void 0:a.price)!==void 0?((s=t.ticketTypes[0])==null?void 0:s.quota)??null:null},J=t=>{const e=w(t),a=C(t);return a&&a>0?`${e}/${a}`:`${e}äººå‚åŠ ä¸­`},O=t=>{const e=y(t);let a=[];return Array.isArray(e.attendeeAvatars)&&e.attendeeAvatars.length?a=e.attendeeAvatars:Array.isArray(e.participants)&&(a=e.participants.map(s=>(s==null?void 0:s.avatarUrl)||i)),!a.length&&Array.isArray(e.attendeePreview)&&(a=e.attendeePreview.map(s=>(s==null?void 0:s.avatarUrl)||i)),a.length||(a=[i,i,i]),a.slice(0,5).map(s=>g(s||i))};return Q(b),(t,e)=>(c(),r("div",at,[_.value?(c(),r("section",et,[(c(),r(h,null,f(3,a=>o("article",{key:a,class:"event-card event-card--skeleton"})),64))])):l.value?(c(),r("section",st,[o("article",ot,[e[1]||(e[1]=o("div",{class:"state-card__icon"},"ðŸš§",-1)),o("div",rt,[e[0]||(e[0]=o("p",{class:"state-card__title"},"æ´»å‹•ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ",-1)),o("p",ct,n(l.value),1)]),o("button",{type:"button",class:"state-card__action",onClick:$,disabled:u.value},n(u.value?"ãƒªãƒˆãƒ©ã‚¤ä¸­â€¦":"å†èª­ã¿è¾¼ã¿"),9,nt)])])):(c(),r("section",it,[A.value.length?W("",!0):(c(),r("p",lt,"æ¡ä»¶ã«åˆã†ã‚¤ãƒ™ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚")),(c(!0),r(h,null,f(A.value,a=>(c(),r("article",{key:a.id,class:"event-card",onClick:s=>N(a.id)},[o("figure",{class:"event-card__cover",style:M(a.coverStyle)},[o("div",dt,[o("div",mt,[(c(!0),r(h,null,f(a.attendees,(s,d)=>(c(),r("img",{key:`${a.id}-attendee-${d}`,src:s,alt:"attendee avatar",style:M({zIndex:a.attendees.length-d})},null,12,pt))),128))]),o("span",_t,n(a.capacityText),1)])],4),o("div",yt,[o("h2",gt,n(a.title),1),o("p",ht,[e[2]||(e[2]=o("span",{class:"i-lucide-clock-8 text-xs"},null,-1)),X(" "+n(a.timeText),1)]),o("div",ft,[o("button",{type:"button",class:"event-card__community-avatar",onClick:Y(s=>B(a.communitySlug),["stop"])},[a.communityLogo?(c(),r("img",{key:0,src:a.communityLogo,alt:"community logo"},null,8,bt)):(c(),r("span",kt,n(a.communityInitial),1))],8,vt),o("p",At,n(a.communityName),1)])])],8,ut))),128))]))]))}}),Tt=tt(wt,[["__scopeId","data-v-50b2aa2a"]]);export{Tt as default};
