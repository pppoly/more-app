import{d as Z,a7 as N,m as k,r as d,c as u,B as z,b as W,g as T,D as x,o as f,e as s,i as t,F as p,h as y,z as j,t as I,j as M,n as H,aa as R,u as L,f as i,_ as Y}from"./index-DncFUGrq.js";const V={class:"events-page"},J={class:"filter-row"},U={class:"segmented"},E=["onClick"],Q={class:"card-list"},F=["onClick"],X={class:"event-body"},K={class:"event-row"},$={class:"event-date"},O={class:"event-title"},q={class:"event-meta"},ee={key:0,class:"empty"},ae={key:1,class:"empty"},te="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQwIiBoZWlnaHQ9IjM2MCIgdmlld0JveD0iMCAwIDY0MCAzNjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPGRlZnM+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImJnIiB4MT0iODAiIHkxPSI0MCIgeDI9IjU2MCIgeTI9IjMyMCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgogICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMjU2M0VCIi8+CiAgICAgIDxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzIyQzU1RSIvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iZ2xvdyIgeDE9IjE0MCIgeTE9IjYwIiB4Mj0iNTIwIiB5Mj0iMzAwIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CiAgICAgIDxzdG9wIHN0b3AtY29sb3I9IndoaXRlIiBzdG9wLW9wYWNpdHk9IjAuMzIiLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSJ3aGl0ZSIgc3RvcC1vcGFjaXR5PSIwLjA1Ii8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogIDwvZGVmcz4KICA8cmVjdCB4PSIyNCIgeT0iMjAiIHdpZHRoPSI1OTIiIGhlaWdodD0iMzIwIiByeD0iMjgiIGZpbGw9InVybCgjYmcpIi8+CiAgPHJlY3QgeD0iNDgiIHk9IjQ0IiB3aWR0aD0iNTQ0IiBoZWlnaHQ9IjI3MiIgcng9IjI0IiBmaWxsPSJ1cmwoI2dsb3cpIi8+CiAgPGNpcmNsZSBjeD0iMTgwIiBjeT0iMTQwIiByPSIyMCIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC41NSIvPgogIDxjaXJjbGUgY3g9IjI0MCIgY3k9IjE0MCIgcj0iMTIiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuNDUiLz4KICA8Y2lyY2xlIGN4PSIzNDAiIGN5PSIxNDAiIHI9IjMwIiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjQ4Ii8+CiAgPGNpcmNsZSBjeD0iNDIwIiBjeT0iMTQwIiByPSIxNiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC40Ii8+CiAgPHJlY3QgeD0iMTcwIiB5PSIyMTAiIHdpZHRoPSIzMDAiIGhlaWdodD0iMTYiIHJ4PSI4IiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjkiLz4KICA8cmVjdCB4PSIyMjAiIHk9IjIzNiIgd2lkdGg9IjIwMCIgaGVpZ2h0PSIxMCIgcng9IjUiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuOCIvPgo8L3N2Zz4K",se=Z({__name:"ConsoleCommunityEventsMobile",setup(ie){const w=z(),m=L(),A=N(),{user:G}=k(),v=d([]),c=d(!1),l=d("open"),S=[{value:"all",label:"すべて"},{value:"open",label:"受付中"},{value:"closed",label:"終了"}];d("");const o=u(()=>w.params.communityId);u(()=>{var e;return!!((e=G.value)!=null&&e.isAdmin)});const r=u(()=>v.value.map(e=>({id:e.id,title:T(e.title),status:e.status,dateTimeText:_(e.startTime,e.endTime),entrySummary:e.visibility==="public"?"公開イベント":"限定公開",coverStyle:{backgroundImage:`url(${e.coverImageUrl?W(e.coverImageUrl):te})`,backgroundSize:"cover",backgroundPosition:"center"}}))),C=u(()=>{const e=l.value==="all"?r.value:r.value.filter(n=>n.status===l.value);return l.value==="open"&&e.length===0?r.value:e}),b=async()=>{if(o.value){c.value=!0;try{v.value=await R(o.value)}catch(e){console.error("Failed to load community events",e)}finally{c.value=!1}}};x(()=>o.value,()=>{o.value&&b()});const h=e=>{m.push({name:"ConsoleMobileEventManage",params:{eventId:e}})},P=()=>{m.back()},_=(e,n)=>{const a=new Date(e).toLocaleString("ja-JP",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});if(!n)return a;const g=new Date(n).toLocaleString("ja-JP",{hour:"2-digit",minute:"2-digit"});return`${a}〜${g}`},B=e=>{switch(e){case"open":return"受付中";case"closed":return"終了";default:return"下書き"}},D=e=>{switch(e){case"open":return"pill open";case"closed":return"pill closed";default:return"pill draft"}};return f(async()=>{await A.loadCommunities(),o.value&&b()}),(e,n)=>(i(),s("div",V,[t("header",{class:"nav-bar"},[t("button",{type:"button",class:"back-btn",onClick:P},"返回")]),t("div",J,[t("div",U,[(i(),s(p,null,y(S,a=>t("button",{key:a.value,class:j(["seg-btn",{active:a.value===l.value}]),onClick:g=>l.value=a.value},I(a.label),11,E)),64))])]),t("section",Q,[(i(!0),s(p,null,y(C.value,a=>(i(),s("article",{key:a.id,class:"event-card",onClick:g=>h(a.id)},[t("figure",{class:"event-cover",style:H(a.coverStyle)},null,4),t("div",X,[t("div",K,[t("p",$,I(a.dateTimeText),1),t("span",{class:j(D(a.status))},I(B(a.status)),3)]),t("h3",O,I(a.title),1),t("p",q,I(a.entrySummary),1)])],8,F))),128)),!C.value.length&&!c.value?(i(),s("div",ee," 没有符合条件的活动。 ")):M("",!0),c.value?(i(),s("div",ae,"加载中...")):M("",!0)])]))}}),oe=Y(se,[["__scopeId","data-v-a4eb3bb1"]]);export{oe as default};
