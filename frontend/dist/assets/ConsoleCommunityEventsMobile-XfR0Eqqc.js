import{d as $,$ as j,l as z,r as p,c as r,z as N,g as V,B as J,o as P,a as l,e as s,h as v,t as u,i as _,F as g,f as C,a1 as R,u as U,b as n,j as w,_ as q}from"./index-X7Vbb3kp.js";const G={class:"px-3 py-3 pb-20"},H={class:"mb-3"},K={class:"text-sm font-semibold text-slate-900"},O={class:"flex gap-2 mb-3 overflow-x-auto no-scrollbar"},Q=["onClick"],W={class:"bg-white rounded-2xl shadow-sm divide-y"},X=["onClick"],Y=["src"],Z={class:"flex-1 min-w-0 text-left"},tt={class:"text-[13px] font-semibold text-slate-900 line-clamp-2"},et={class:"mt-0.5 text-[11px] text-slate-400"},st={key:0,class:"px-3 py-4 text-center text-[11px] text-slate-400"},at={key:1,class:"px-3 py-4 text-center text-[11px] text-slate-400"},ot=$({__name:"ConsoleCommunityEventsMobile",setup(lt){const k=N(),d=U(),x=j(),{user:E}=z(),b=p([]),i=p(!1),c=p("all"),T=[{value:"all",label:"すべて"},{value:"open",label:"受付中"},{value:"closed",label:"終了"}],o=r(()=>k.params.communityId),B=r(()=>{const t=x.communities.value.find(a=>a.id===o.value);return(t==null?void 0:t.name)??"未選択"}),M=r(()=>{var t;return!!((t=E.value)!=null&&t.isAdmin)}),y=r(()=>b.value.map(t=>({id:t.id,title:V(t.title),status:t.status,dateTimeText:A(t.startTime,t.endTime),entrySummary:t.visibility==="public"?"公開イベント":"限定公開",coverUrl:"https://placehold.co/120x120?text=Event"}))),h=r(()=>c.value==="all"?y.value:y.value.filter(t=>t.status===c.value)),f=async()=>{if(o.value){i.value=!0;try{b.value=await R(o.value)}catch(t){console.error("Failed to load community events",t)}finally{i.value=!1}}};J(()=>o.value,()=>{o.value&&f()});const S=t=>{d.push({name:"ConsoleMobileEventManage",params:{eventId:t}})},D=()=>{o.value&&d.push({name:"ConsoleMobileEventForm",params:{communityId:o.value}})},I=()=>{o.value&&d.push({name:"ConsoleMobileAssistantDashboard",params:{communityId:o.value}})},A=(t,a)=>{const e=new Date(t).toLocaleString("ja-JP",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});if(!a)return e;const m=new Date(a).toLocaleString("ja-JP",{hour:"2-digit",minute:"2-digit"});return`${e}〜${m}`},F=t=>{switch(t){case"open":return"受付中";case"closed":return"終了";default:return"下書き"}},L=t=>{switch(t){case"open":return"bg-emerald-100 text-emerald-700";case"closed":return"bg-slate-100 text-slate-500";default:return"bg-amber-100 text-amber-700"}};return P(async()=>{await x.loadCommunities(),o.value&&f()}),(t,a)=>(n(),l("div",G,[s("header",H,[a[1]||(a[1]=s("p",{class:"text-[11px] text-slate-400"},"コミュニティ",-1)),s("h1",K,u(B.value),1),a[2]||(a[2]=s("p",{class:"mt-0.5 text-[11px] text-slate-400"},"全てのイベント一覧",-1)),M.value?(n(),l("button",{key:0,type:"button",class:"dashboard-link",onClick:I},[...a[0]||(a[0]=[s("span",{class:"i-lucide-activity mr-1"},null,-1),_(" AI助手仪表盘 ",-1)])])):v("",!0)]),s("div",O,[(n(),l(g,null,C(T,e=>s("button",{key:e.value,class:w(["px-3 py-1 rounded-full text-xs border whitespace-nowrap",e.value===c.value?"bg-[#00B900] border-[#00B900] text-white":"bg-white border-slate-200 text-slate-600"]),onClick:m=>c.value=e.value},u(e.label),11,Q)),64))]),s("div",W,[(n(!0),l(g,null,C(h.value,e=>(n(),l("button",{key:e.id,class:"w-full px-3 py-2 flex items-center active:bg-slate-50",onClick:m=>S(e.id)},[s("img",{src:e.coverUrl,class:"w-10 h-10 rounded-xl object-cover mr-3 flex-shrink-0",alt:""},null,8,Y),s("div",Z,[s("p",tt,u(e.title),1),s("p",et,u(e.dateTimeText)+" · "+u(e.entrySummary),1)]),s("span",{class:w(["ml-2 px-2 py-0.5 rounded-full text-[10px]",L(e.status)])},u(F(e.status)),3)],8,X))),128)),!h.value.length&&!i.value?(n(),l("div",st," 条件に合うイベントがありません。 ")):v("",!0),i.value?(n(),l("div",at,"読み込み中...")):v("",!0)]),s("div",{class:"mt-4"},[s("button",{type:"button",class:"create-event-button",onClick:D},[...a[3]||(a[3]=[s("span",{class:"i-lucide-plus mr-2 text-lg"},null,-1),_(" 新しいイベントを作成 ",-1)])])])]))}}),ut=q(ot,[["__scopeId","data-v-0bd90d98"]]);export{ut as default};
