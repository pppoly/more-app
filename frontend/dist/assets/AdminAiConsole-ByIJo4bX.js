import{d as J,r as v,o as A,e as n,i as l,j as c,k as p,x as m,K as I,F as C,h as P,t as d,y as x,aB as F,aC as R,aD as M,aE as j,aF as B,aG as E,f as u,_ as D}from"./index-DncFUGrq.js";const G={class:"ai-console"},K={class:"page-head"},q={class:"actions"},z=["disabled"],H={class:"card"},Q={class:"form-grid"},W=["value"],X={class:"btn-row"},Y=["disabled"],Z=["disabled"],$={key:0,class:"result"},ee={key:1,class:"result"},le={key:2,class:"error"},te={key:3,class:"error"},ae={class:"card"},se={class:"form-grid"},oe=["value"],ne=["value"],ue={class:"btn-row"},re=["disabled"],de={key:0,class:"result"},ve={key:1,class:"error"},ie={class:"card"},pe={class:"card-head"},me=["disabled"],ce=["value"],ge={key:0,class:"result"},ye={key:1,class:"error"},be=J({__name:"AdminAiConsole",setup(fe){const k=v([]),g=v([]),r=v({prompts:!1,render:!1,complete:!1,translate:!1,eval:!1}),o=v({render:null,complete:null,translate:null,eval:null}),y=v(""),b=v(""),f=v(""),_=v(""),L=v(""),s=v({promptId:"",paramsText:"",messagesText:'[{"role":"user","content":"hello"}]',model:"",temperature:.3}),i=v({sourceLang:"ja",targetLang:"en",text:""}),S=()=>{var a;s.value={promptId:((a=k.value[0])==null?void 0:a.id)??"",paramsText:"",messagesText:'[{"role":"user","content":"hello"}]',model:"",temperature:.3},y.value="",b.value="",o.value.render=null,o.value.complete=null},w=()=>{i.value={sourceLang:g.value[0]??"ja",targetLang:g.value[0]??"en",text:""},f.value="",o.value.translate=null},V=async()=>{r.value.prompts=!0;try{const[a,e]=await Promise.all([F(),R()]);k.value=a,g.value=e.supported??[],!s.value.promptId&&a.length&&(s.value.promptId=a[0].id,L.value=a[0].id),w()}catch(a){console.error(a)}finally{r.value.prompts=!1}},T=(a,e)=>{try{return JSON.parse(a)}catch{return e}},N=async()=>{o.value.render=null,y.value="",r.value.render=!0;try{const a=T(s.value.paramsText||"{}",{}),e=T(s.value.messagesText||"[]",[]),t=await M({promptId:s.value.promptId,params:a,messages:e,model:s.value.model||void 0});y.value=JSON.stringify(t.messages,null,2)}catch(a){o.value.render=(a==null?void 0:a.message)||"渲染失败"}finally{r.value.render=!1}},O=async()=>{o.value.complete=null,b.value="",r.value.complete=!0;try{const a=T(s.value.paramsText||"{}",{}),e=T(s.value.messagesText||"[]",[]),t=await j({promptId:s.value.promptId,params:a,messages:e,model:s.value.model||void 0,temperature:s.value.temperature||void 0});b.value=JSON.stringify(t,null,2)}catch(a){o.value.complete=(a==null?void 0:a.message)||"调用失败"}finally{r.value.complete=!1}},U=async()=>{o.value.translate=null,f.value="",r.value.translate=!0;try{const a=await B({sourceLang:i.value.sourceLang,targetLangs:[i.value.targetLang],items:[{key:"text",text:i.value.text}]});f.value=JSON.stringify(a.translations,null,2)}catch(a){o.value.translate=(a==null?void 0:a.message)||"翻译失败"}finally{r.value.translate=!1}},h=async()=>{o.value.eval=null,_.value="",r.value.eval=!0;try{const a=await E({promptId:L.value});_.value=JSON.stringify(a,null,2)}catch(a){o.value.eval=(a==null?void 0:a.message)||"评测失败"}finally{r.value.eval=!1}};return A(()=>{V()}),(a,e)=>(u(),n("main",G,[l("header",K,[e[9]||(e[9]=l("div",null,[l("p",{class:"eyebrow"},"SOCIALMORE · AI 控制台"),l("h1",null,"Prompt 测试与日志"),l("p",{class:"subhead"},"可视化验证渲染/调用、翻译与评测结果，快速检查最新 Prompt。")],-1)),l("div",q,[l("button",{type:"button",class:"outline",onClick:V,disabled:r.value.prompts},"刷新列表",8,z)])]),l("section",H,[l("div",{class:"card-head"},[e[10]||(e[10]=l("h2",null,"Prompt 渲染 & 调用",-1)),l("button",{type:"button",class:"ghost",onClick:S},"清空")]),l("div",Q,[l("label",null,[e[11]||(e[11]=p(" Prompt ",-1)),m(l("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>s.value.promptId=t)},[(u(!0),n(C,null,P(k.value,t=>(u(),n("option",{key:t.id,value:t.id},d(t.id)+" ("+d(t.status||"draft")+") ",9,W))),128))],512),[[I,s.value.promptId]])]),l("label",null,[e[12]||(e[12]=p(" 模型 ",-1)),m(l("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.model=t),type:"text",placeholder:"默认后端配置"},null,512),[[x,s.value.model]])]),l("label",null,[e[13]||(e[13]=p(" 温度 ",-1)),m(l("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>s.value.temperature=t),type:"number",step:"0.1",min:"0",max:"1"},null,512),[[x,s.value.temperature,void 0,{number:!0}]])])]),l("label",null,[e[14]||(e[14]=p(" Params (JSON) ",-1)),m(l("textarea",{"onUpdate:modelValue":e[3]||(e[3]=t=>s.value.paramsText=t),rows:"3",placeholder:'{"source_lang":"en","target_lang":"ja"}'},null,512),[[x,s.value.paramsText]])]),l("label",null,[e[15]||(e[15]=p(" Messages (JSON 数组) ",-1)),m(l("textarea",{"onUpdate:modelValue":e[4]||(e[4]=t=>s.value.messagesText=t),rows:"4",placeholder:'[{"role":"user","content":"hello"}]'},null,512),[[x,s.value.messagesText]])]),l("div",X,[l("button",{type:"button",class:"outline",onClick:N,disabled:r.value.render},"渲染",8,Y),l("button",{type:"button",class:"primary",onClick:O,disabled:r.value.complete},"调用",8,Z)]),y.value?(u(),n("div",$,[e[16]||(e[16]=l("p",{class:"muted"},"渲染结果",-1)),l("pre",null,d(y.value),1)])):c("",!0),b.value?(u(),n("div",ee,[e[17]||(e[17]=l("p",{class:"muted"},"调用结果",-1)),l("pre",null,d(b.value),1)])):c("",!0),o.value.render?(u(),n("div",le,d(o.value.render),1)):c("",!0),o.value.complete?(u(),n("div",te,d(o.value.complete),1)):c("",!0)]),l("section",ae,[l("div",{class:"card-head"},[e[18]||(e[18]=l("h2",null,"翻译测试",-1)),l("button",{type:"button",class:"ghost",onClick:w},"清空")]),l("div",se,[l("label",null,[e[19]||(e[19]=p(" 源语言 ",-1)),m(l("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>i.value.sourceLang=t)},[(u(!0),n(C,null,P(g.value,t=>(u(),n("option",{key:t,value:t},d(t),9,oe))),128))],512),[[I,i.value.sourceLang]])]),l("label",null,[e[20]||(e[20]=p(" 目标语言 ",-1)),m(l("select",{"onUpdate:modelValue":e[6]||(e[6]=t=>i.value.targetLang=t)},[(u(!0),n(C,null,P(g.value,t=>(u(),n("option",{key:t,value:t},d(t),9,ne))),128))],512),[[I,i.value.targetLang]])])]),l("label",null,[e[21]||(e[21]=p(" 文本 ",-1)),m(l("textarea",{"onUpdate:modelValue":e[7]||(e[7]=t=>i.value.text=t),rows:"3",placeholder:"待翻译文本"},null,512),[[x,i.value.text]])]),l("div",ue,[l("button",{type:"button",class:"primary",onClick:U,disabled:r.value.translate},"测试翻译",8,re)]),f.value?(u(),n("div",de,[e[22]||(e[22]=l("p",{class:"muted"},"翻译结果",-1)),l("pre",null,d(f.value),1)])):c("",!0),o.value.translate?(u(),n("div",ve,d(o.value.translate),1)):c("",!0)]),l("section",ie,[l("div",pe,[e[23]||(e[23]=l("h2",null,"评测（渲染用例）",-1)),l("button",{type:"button",class:"ghost",onClick:h,disabled:r.value.eval},"运行",8,me)]),l("label",null,[e[24]||(e[24]=p(" Prompt ",-1)),m(l("select",{"onUpdate:modelValue":e[8]||(e[8]=t=>L.value=t)},[(u(!0),n(C,null,P(k.value,t=>(u(),n("option",{key:t.id,value:t.id},d(t.id)+" ("+d(t.status||"draft")+") ",9,ce))),128))],512),[[I,L.value]])]),_.value?(u(),n("div",ge,[e[25]||(e[25]=l("p",{class:"muted"},"评测结果",-1)),l("pre",null,d(_.value),1)])):c("",!0),o.value.eval?(u(),n("div",ye,d(o.value.eval),1)):c("",!0)])]))}}),ke=D(be,[["__scopeId","data-v-20bef64a"]]);export{ke as default};
