import{d as L,Q as D,r as m,c as i,y as F,g as $,A as j,o as z,a as l,e as s,t as n,F as b,f,n as y,h as g,R as I,u as N,b as r,_ as R}from"./index-BPws346P.js";const J={class:"px-3 py-3 pb-20"},P={class:"mb-3"},U={class:"text-sm font-semibold text-slate-900"},V={class:"flex gap-2 mb-3 overflow-x-auto no-scrollbar"},A=["onClick"],Q={class:"bg-white rounded-2xl shadow-sm divide-y"},q=["onClick"],G=["src"],H={class:"flex-1 min-w-0 text-left"},K={class:"text-[13px] font-semibold text-slate-900 line-clamp-2"},O={class:"mt-0.5 text-[11px] text-slate-400"},W={key:0,class:"px-3 py-4 text-center text-[11px] text-slate-400"},X={key:1,class:"px-3 py-4 text-center text-[11px] text-slate-400"},Y=L({__name:"ConsoleCommunityEventsMobile",setup(Z){const C=F(),w=N(),x=D(),p=m([]),c=m(!1),u=m("all"),k=[{value:"all",label:"すべて"},{value:"open",label:"受付中"},{value:"closed",label:"終了"}],o=i(()=>C.params.communityId),E=i(()=>{const e=x.communities.value.find(a=>a.id===o.value);return(e==null?void 0:e.name)??"未選択"}),v=i(()=>p.value.map(e=>({id:e.id,title:$(e.title),status:e.status,dateTimeText:S(e.startTime,e.endTime),entrySummary:e.visibility==="public"?"公開イベント":"限定公開",coverUrl:"https://placehold.co/120x120?text=Event"}))),_=i(()=>u.value==="all"?v.value:v.value.filter(e=>e.status===u.value)),h=async()=>{if(o.value){c.value=!0;try{p.value=await I(o.value)}catch(e){console.error("Failed to load community events",e)}finally{c.value=!1}}};j(()=>o.value,()=>{o.value&&h()});const T=e=>{w.push({name:"ConsoleMobileEventManage",params:{eventId:e}})},S=(e,a)=>{const t=new Date(e).toLocaleString("ja-JP",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});if(!a)return t;const d=new Date(a).toLocaleString("ja-JP",{hour:"2-digit",minute:"2-digit"});return`${t}〜${d}`},B=e=>{switch(e){case"open":return"受付中";case"closed":return"終了";default:return"下書き"}},M=e=>{switch(e){case"open":return"bg-emerald-100 text-emerald-700";case"closed":return"bg-slate-100 text-slate-500";default:return"bg-amber-100 text-amber-700"}};return z(async()=>{await x.loadCommunities(),o.value&&h()}),(e,a)=>(r(),l("div",J,[s("header",P,[a[0]||(a[0]=s("p",{class:"text-[11px] text-slate-400"},"コミュニティ",-1)),s("h1",U,n(E.value),1),a[1]||(a[1]=s("p",{class:"mt-0.5 text-[11px] text-slate-400"},"全てのイベント一覧",-1))]),s("div",V,[(r(),l(b,null,f(k,t=>s("button",{key:t.value,class:y(["px-3 py-1 rounded-full text-xs border whitespace-nowrap",t.value===u.value?"bg-[#00B900] border-[#00B900] text-white":"bg-white border-slate-200 text-slate-600"]),onClick:d=>u.value=t.value},n(t.label),11,A)),64))]),s("div",Q,[(r(!0),l(b,null,f(_.value,t=>(r(),l("button",{key:t.id,class:"w-full px-3 py-2 flex items-center active:bg-slate-50",onClick:d=>T(t.id)},[s("img",{src:t.coverUrl,class:"w-10 h-10 rounded-xl object-cover mr-3 flex-shrink-0",alt:""},null,8,G),s("div",H,[s("p",K,n(t.title),1),s("p",O,n(t.dateTimeText)+" · "+n(t.entrySummary),1)]),s("span",{class:y(["ml-2 px-2 py-0.5 rounded-full text-[10px]",M(t.status)])},n(B(t.status)),3)],8,q))),128)),!_.value.length&&!c.value?(r(),l("div",W," 条件に合うイベントがありません。 ")):g("",!0),c.value?(r(),l("div",X,"読み込み中...")):g("",!0)])]))}}),te=R(Y,[["__scopeId","data-v-95d70f70"]]);export{te as default};
