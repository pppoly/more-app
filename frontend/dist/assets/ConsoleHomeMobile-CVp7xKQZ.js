import{d as at,a7 as lt,r as v,c as I,b as z,g as ot,o as nt,D as L,a9 as ct,e as l,A as R,i as t,j as A,t as u,k as H,z as r,F as j,h as f,w as It,v as ut,p as dt,aa as rt,u as mt,f as o,_ as gt}from"./index-DncFUGrq.js";import{P as vt}from"./PageMarker-B9WMY3Nd.js";const Ct={class:"console-home"},pt={class:"top-bar"},yt=["src"],bt={class:"top-title"},Mt={class:"top-role"},At={class:"stat-row"},jt={class:"stat-chip"},kt={class:"stat-value"},Gt={class:"stat-chip"},Pt={class:"stat-value"},wt={class:"stat-chip"},Dt={class:"stat-value"},Nt={class:"action-grid"},Zt={class:"events-section"},St={class:"event-cards"},Bt=["onClick"],ht={class:"event-date"},Tt={class:"event-meta"},Wt={key:0,class:"event-empty"},xt={class:"picker-sheet"},zt={class:"picker-list"},Lt={key:0,class:"picker-empty"},Rt=["onClick"],Ht={class:"picker-name"},ft={class:"picker-slug"},Yt={key:0,class:"i-lucide-check"},Vt={key:0,class:"picker-empty"},Jt="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwIiBoZWlnaHQ9IjEyMCIgdmlld0JveD0iMCAwIDEyMCAxMjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPGRlZnM+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImciIHgxPSIxNCIgeTE9IjE0IiB4Mj0iMTA2IiB5Mj0iMTA2IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CiAgICAgIDxzdG9wIHN0b3AtY29sb3I9IiMyNTYzRUIiLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjMjJDNTVFIi8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogIDwvZGVmcz4KICA8cmVjdCB4PSI0IiB5PSI0IiB3aWR0aD0iMTEyIiBoZWlnaHQ9IjExMiIgcng9IjMyIiBmaWxsPSJ1cmwoI2cpIi8+CiAgPHJlY3QgeD0iMTgiIHk9IjMyIiB3aWR0aD0iODQiIGhlaWdodD0iNTYiIHJ4PSIyMCIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC4xMiIvPgogIDxjaXJjbGUgY3g9IjQwIiBjeT0iNjAiIHI9IjEyIiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjkiLz4KICA8Y2lyY2xlIGN4PSI4MCIgY3k9IjYwIiByPSIxMiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC45Ii8+CiAgPHJlY3QgeD0iMzAiIHk9IjgwIiB3aWR0aD0iNjAiIGhlaWdodD0iNiIgcng9IjMiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuNzUiLz4KICA8cGF0aCBkPSJNNjAgMjZjLTggMC0xNC41IDYuNS0xNC41IDE0LjVTNTIgNTUgNjAgNTVzMTQuNS02LjUgMTQuNS0xNC41UzY4IDI2IDYwIDI2WiIgZmlsbD0iIzBFQTVFOSIgZmlsbC1vcGFjaXR5PSIwLjI4Ii8+CiAgPHBhdGggZD0iTTYwIDMyYy01LjUgMC0xMCA0LjUtMTAgMTBzNC41IDEwIDEwIDEwIDEwLTQuNSAxMC0xMC00LjUtMTAtMTAtMTBaIiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjkiLz4KPC9zdmc+Cg==",g="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZGVmcz4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iZyIgeDE9IjYiIHkxPSI2IiB4Mj0iNDIiIHkyPSI0MiIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgogICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMjU2M0VCIi8+CiAgICAgIDxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzIyQzU1RSIvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICA8L2RlZnM+CiAgPHJlY3QgeD0iNCIgeT0iNCIgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiByeD0iMTIiIGZpbGw9InVybCgjZykiLz4KICA8cGF0aCBkPSJNMjQgMTR2MjBNMTQgMjRoMjAiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iNCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBvcGFjaXR5PSIwLjk1Ii8+Cjwvc3ZnPgo=",_t="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQwIiBoZWlnaHQ9IjM2MCIgdmlld0JveD0iMCAwIDY0MCAzNjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPGRlZnM+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImJnIiB4MT0iODAiIHkxPSI0MCIgeDI9IjU2MCIgeTI9IjMyMCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgogICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMjU2M0VCIi8+CiAgICAgIDxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzIyQzU1RSIvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iZ2xvdyIgeDE9IjE0MCIgeTE9IjYwIiB4Mj0iNTIwIiB5Mj0iMzAwIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CiAgICAgIDxzdG9wIHN0b3AtY29sb3I9IndoaXRlIiBzdG9wLW9wYWNpdHk9IjAuMzIiLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSJ3aGl0ZSIgc3RvcC1vcGFjaXR5PSIwLjA1Ii8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogIDwvZGVmcz4KICA8cmVjdCB4PSIyNCIgeT0iMjAiIHdpZHRoPSI1OTIiIGhlaWdodD0iMzIwIiByeD0iMjgiIGZpbGw9InVybCgjYmcpIi8+CiAgPHJlY3QgeD0iNDgiIHk9IjQ0IiB3aWR0aD0iNTQ0IiBoZWlnaHQ9IjI3MiIgcng9IjI0IiBmaWxsPSJ1cmwoI2dsb3cpIi8+CiAgPGNpcmNsZSBjeD0iMTgwIiBjeT0iMTQwIiByPSIyMCIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC41NSIvPgogIDxjaXJjbGUgY3g9IjI0MCIgY3k9IjE0MCIgcj0iMTIiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuNDUiLz4KICA8Y2lyY2xlIGN4PSIzNDAiIGN5PSIxNDAiIHI9IjMwIiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjQ4Ii8+CiAgPGNpcmNsZSBjeD0iNDIwIiBjeT0iMTQwIiByPSIxNiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC40Ii8+CiAgPHJlY3QgeD0iMTcwIiB5PSIyMTAiIHdpZHRoPSIzMDAiIGhlaWdodD0iMTYiIHJ4PSI4IiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjkiLz4KICA8cmVjdCB4PSIyMjAiIHk9IjIzNiIgd2lkdGg9IjIwMCIgaGVpZ2h0PSIxMCIgcng9IjUiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuOCIvPgo8L3N2Zz4K",Ut=at({__name:"ConsoleHomeMobile",setup(Qt){const d=mt(),c=lt(),k=v([]),N=v(!1),p=v(!1),G=v(!1),C=v(null),P=v(!0);let y=0;const b=I(()=>c.getActiveCommunity()),Z=I(()=>c.communities.value),S=I(()=>c.activeCommunityId.value),Y=I(()=>{var s;return((s=b.value)==null?void 0:s.name)??""}),a=I(()=>c.activeCommunityId.value),n=I(()=>!!a.value),V=I(()=>C.value||Jt),J=I(()=>{var i;switch((i=b.value)==null?void 0:i.role){case"owner":return"主催者";case"admin":return"管理者";default:return"メンバー"}}),w=I(()=>({monthRevenueText:"¥0",eventCount:k.value.length,registrationCount:"--"})),_=I(()=>c.activeCommunityVersion.value),B=I(()=>k.value.slice(0,5).map(s=>({id:s.id,title:ot(s.title),status:s.status,dateTimeText:tt(s.startTime,s.endTime),entrySummary:s.visibility==="public"?"公開イベント":"限定公開",coverUrl:s.coverImageUrl?z(s.coverImageUrl):_t}))),h=async()=>{if(a.value){N.value=!0;try{k.value=await rt(a.value)}catch(s){console.error("Failed to load console events",s)}finally{N.value=!1}}},U=async()=>{p.value=!0,!c.loaded.value&&!c.loading.value&&(G.value=!0,await c.loadCommunities(!0),G.value=!1)},Q=s=>{c.setActiveCommunity(s),p.value=!1,M()},D=()=>{p.value=!1},T=()=>{d.push({name:"ConsoleMobileCommunityCreate"})},E=()=>{d.push({name:"ConsoleMobilePayout"})},F=()=>{d.push({name:"ConsoleMobileSubscription"})},W=()=>{a.value&&d.push({name:"ConsoleMobileCommunitySettings",params:{communityId:a.value}})},X=()=>{var s;(s=b.value)!=null&&s.slug&&d.push({name:"community-portal",params:{slug:b.value.slug}})},K=()=>{d.push({name:"ConsoleTicketScanner"})},x=()=>{a.value&&d.push({name:"ConsoleMobileCommunityEvents",params:{communityId:a.value}})},O=s=>{d.push({name:"ConsoleMobileEventManage",params:{eventId:s}})},$=()=>{a.value&&d.push({name:"ConsoleMobileEventForm",params:{communityId:a.value}})},q=()=>{a.value&&d.push({name:"ConsoleMobileEventCreate",params:{communityId:a.value}})},tt=(s,i)=>{const m=new Date(s).toLocaleString("ja-JP",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});if(!i)return m;const e=new Date(i).toLocaleString("ja-JP",{hour:"2-digit",minute:"2-digit"});return`${m}〜${e}`},it=s=>{switch(s){case"open":return"受付中";case"closed":return"終了";default:return"下書き"}},st=s=>{switch(s){case"open":return"bg-emerald-100 text-emerald-700";case"closed":return"bg-slate-100 text-slate-500";default:return"bg-amber-100 text-amber-700"}};v(!1),nt(async()=>{await c.loadCommunities(),a.value||c.ensureActiveCommunity(),a.value&&(h(),M())}),L(()=>a.value,(s,i)=>{s&&s!==i&&(h(),M()),s||(C.value=null)}),L(()=>_.value,()=>{a.value&&M()});const M=async()=>{if(!a.value){C.value=null,P.value=!1;return}const s=++y;C.value=null,P.value=!0;try{const i=await ct(a.value),m=typeof i.description=="object"&&i.description?i.description:null,e=(m==null?void 0:m.logoImageUrl)||null;s===y&&(C.value=e?z(e):null)}catch{s===y&&(C.value=null)}finally{s===y&&(P.value=!1)}};return(s,i)=>{const m=dt("RouterLink");return o(),l(j,null,[R(vt,{label:"P1"}),t("div",Ct,[t("section",pt,[t("button",{class:"avatar-btn",type:"button",onClick:W},[(o(),l("img",{key:a.value||"default",src:V.value,alt:"avatar"},null,8,yt))]),t("div",{class:"top-text",onClick:W},[i[0]||(i[0]=t("p",{class:"top-label"},"社群",-1)),t("h1",bt,u(Y.value||"未選択のコミュニティ"),1),t("p",Mt,u(n.value?`役割: ${J.value}`:"まずはコミュニティを登録"),1)]),n.value?(o(),l("button",{key:0,class:"pill-btn",type:"button",onClick:U}," 切り替え ")):(o(),l("button",{key:1,class:"pill-btn pill-btn--primary",type:"button",onClick:T},[...i[1]||(i[1]=[t("span",{class:"i-lucide-sparkles"},null,-1),H(" 新建 ",-1)])]))]),t("section",At,[t("article",jt,[i[2]||(i[2]=t("p",{class:"stat-label"},"今月の収入",-1)),t("p",kt,u(n.value?w.value.monthRevenueText:"---"),1)]),t("article",Gt,[i[3]||(i[3]=t("p",{class:"stat-label"},"今月のイベント",-1)),t("p",Pt,u(n.value?w.value.eventCount:"--"),1)]),t("article",wt,[i[4]||(i[4]=t("p",{class:"stat-label"},"申込数",-1)),t("p",Dt,u(n.value?w.value.registrationCount:"--"),1)])]),t("section",Nt,[t("button",{class:"action-card",type:"button",onClick:T},[t("div",{class:"action-entry"},[t("div",{class:"action-icon"},[t("img",{src:g,alt:""})]),i[5]||(i[5]=t("div",null,[t("p",{class:"action-title"},"コミュニティ作成"),t("p",{class:"action-desc"},"新しいコミュニティを登録")],-1))])]),t("button",{class:r(["action-card",{"is-disabled":!n.value}]),type:"button",onClick:$},[t("div",{class:"action-entry"},[t("div",{class:"action-icon"},[t("img",{src:g,alt:""})]),i[6]||(i[6]=t("div",null,[t("p",{class:"action-title"},"新しいイベント"),t("p",{class:"action-desc"},"イベントを作成して公開")],-1))])],2),t("button",{class:r(["action-card",{"is-disabled":!n.value}]),type:"button",onClick:q},[t("div",{class:"action-entry"},[t("div",{class:"action-icon"},[t("img",{src:g,alt:""})]),i[7]||(i[7]=t("div",null,[t("p",{class:"action-title"},"AI イベント助手"),t("p",{class:"action-desc"},"SOCIALMORE 憲法で企画")],-1))])],2),t("button",{class:r(["action-card",{"is-disabled":!n.value}]),type:"button",onClick:x},[t("div",{class:"action-entry"},[t("div",{class:"action-icon"},[t("img",{src:g,alt:""})]),i[8]||(i[8]=t("div",null,[t("p",{class:"action-title"},"イベント管理"),t("p",{class:"action-desc"},"登録状況と参加者を確認")],-1))])],2),t("button",{class:r(["action-card",{"is-disabled":!n.value}]),type:"button",onClick:E},[t("div",{class:"action-entry"},[t("div",{class:"action-icon"},[t("img",{src:g,alt:""})]),i[9]||(i[9]=t("div",null,[t("p",{class:"action-title"},"収益と入金"),t("p",{class:"action-desc"},"入金設定・請求を確認")],-1))])],2),t("button",{class:r(["action-card",{"is-disabled":!n.value}]),type:"button",onClick:F},[t("div",{class:"action-entry"},[t("div",{class:"action-icon"},[t("img",{src:g,alt:""})]),i[10]||(i[10]=t("div",null,[t("p",{class:"action-title"},"プランと設定"),t("p",{class:"action-desc"},"プラン変更や通知設定")],-1))])],2),t("button",{class:r(["action-card",{"is-disabled":!n.value}]),type:"button",onClick:X},[t("div",{class:"action-entry"},[t("div",{class:"action-icon"},[t("img",{src:g,alt:""})]),i[11]||(i[11]=t("div",null,[t("p",{class:"action-title"},"公開ページを見る"),t("p",{class:"action-desc"},"社群ポータルを確認（ユーザー側表示）")],-1))])],2),t("button",{class:r(["action-card",{"is-disabled":!n.value}]),type:"button",onClick:K},[t("div",{class:"action-entry"},[t("div",{class:"action-icon"},[t("img",{src:g,alt:""})]),i[12]||(i[12]=t("div",null,[t("p",{class:"action-title"},"验票扫码"),t("p",{class:"action-desc"},"ストアフロントでQRを読み取る")],-1))])],2)]),t("section",Zt,[t("div",{class:"section-head"},[i[13]||(i[13]=t("div",null,[t("p",{class:"section-label"},"イベントの進行状況"),t("h2",null,"最新イベント")],-1)),t("button",{class:"link-button",type:"button",onClick:x},"一覧を見る")]),t("div",St,[(o(!0),l(j,null,f(B.value,e=>(o(),l("button",{key:e.id,class:"event-card",type:"button",onClick:et=>O(e.id)},[t("div",{class:r(["event-status",st(e.status)])},u(it(e.status)),3),t("p",ht,u(e.dateTimeText),1),t("h3",null,u(e.title),1),t("p",Tt,u(e.entrySummary),1)],8,Bt))),128)),B.value.length?A("",!0):(o(),l("div",Wt," まだイベントがありません。新しい企画を始めましょう。 "))])]),p.value?(o(),l("div",{key:0,class:"picker-overlay",onClick:It(D,["self"])},[t("div",xt,[t("header",{class:"picker-head"},[i[15]||(i[15]=t("p",{class:"picker-title"},"社群を切り替え",-1)),t("button",{type:"button",class:"picker-close",onClick:D},[...i[14]||(i[14]=[t("span",{class:"i-lucide-x"},null,-1)])])]),t("div",zt,[G.value?(o(),l("div",Lt,"読み込み中…")):(o(),l(j,{key:1},[(o(!0),l(j,null,f(Z.value,e=>(o(),l("button",{key:e.id,class:r(["picker-item",{"is-active":e.id===S.value}]),type:"button",onClick:et=>Q(e.id)},[t("div",null,[t("p",Ht,u(e.name),1),t("p",ft,"@"+u(e.slug),1)]),e.id===S.value?(o(),l("span",Yt)):A("",!0)],10,Rt))),128)),Z.value.length?A("",!0):(o(),l("p",Vt,"まだ社群がありません。")),R(m,{class:"picker-add",to:{name:"ConsoleMobileCommunityCreate"},onClick:D},{default:ut(()=>[...i[16]||(i[16]=[t("span",{class:"i-lucide-plus"},null,-1),H(" 新しい社群を登録 ",-1)])]),_:1})],64))])])])):A("",!0)])],64)}}}),Xt=gt(Ut,[["__scopeId","data-v-23a42360"]]);export{Xt as default};
