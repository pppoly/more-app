import{d as B,c as P,B as M,r as c,o as I,e as t,i as s,u as V,t as d,F as _,h as y,ap as z,aq as A,f as o,z as f,j as D,x as F,P as L,_ as N}from"./index-D9GuT0xz.js";const R={class:"portal-config-page"},S={key:0,class:"portal-config__card"},j={key:1,class:"status error"},q={key:2,class:"portal-config__card"},E={class:"theme-grid"},O=["onClick"],T={class:"theme-meta"},U={class:"theme-name"},$={class:"theme-desc"},G={key:0,class:"badge"},H={class:"module-list"},J=["value"],K={class:"module-name"},Q={class:"module-desc"},W={class:"portal-actions"},X=["disabled"],Y=B({__name:"ConsoleCommunityPortalMobile",setup(Z){const h=M(),g=V(),u=P(()=>h.params.communityId),v=c(!0),r=c(!1),l=c(null),n=c("immersive"),m=c(["hero","about","upcoming","past","moments"]),C=[{id:"clean",name:"清爽卡片",desc:"浅色卡片 + 淡渐变",previewClass:"preview-clean"},{id:"immersive",name:"沉浸大片",desc:"暗色遮罩 + 大封面",previewClass:"preview-immersive"},{id:"warm",name:"暖色聚会",desc:"暖色调覆盖 + 圆角卡片",previewClass:"preview-warm"},{id:"collage",name:"拼贴影集",desc:"纹理叠加 + 照片感",previewClass:"preview-collage"}],b=[{id:"hero",name:"封面",desc:"封面大图与标签滚动"},{id:"about",name:"简介",desc:"社群介绍文本"},{id:"upcoming",name:"招募中活动",desc:"当前可报名的活动"},{id:"past",name:"往期活动",desc:"历史活动列表"},{id:"moments",name:"精彩瞬間",desc:"精选照片/封面拼贴"}],w=async()=>{var i,a;if(u.value){v.value=!0,l.value=null;try{const{config:e}=await z(u.value);n.value=e.theme||n.value,Array.isArray(e.layout)&&e.layout.length&&(m.value=[...new Set(e.layout)])}catch(e){l.value=((a=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:a.message)||"設定を読み込めませんでした"}finally{v.value=!1}}},k=async()=>{var i,a;if(u.value){r.value=!0,l.value=null;try{await A(u.value,{theme:n.value,layout:m.value})}catch(e){l.value=((a=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:a.message)||"保存に失敗しました"}finally{r.value=!1}}},x=()=>g.back();return I(w),(i,a)=>(o(),t("div",R,[s("header",{class:"portal-config__header"},[s("button",{class:"back-btn",type:"button",onClick:x},"←"),a[1]||(a[1]=s("div",null,[s("p",{class:"eyebrow"},"社群门户"),s("h1",null,"门户模板")],-1))]),v.value?(o(),t("div",S,[...a[2]||(a[2]=[s("p",null,"読み込み中...",-1)])])):l.value?(o(),t("p",j,d(l.value),1)):(o(),t("div",q,[a[3]||(a[3]=s("h2",null,"选择模板",-1)),s("div",E,[(o(),t(_,null,y(C,e=>s("button",{key:e.id,type:"button",class:f(["theme-card",{active:n.value===e.id}]),onClick:p=>n.value=e.id},[s("div",{class:f(["theme-preview",e.previewClass])},null,2),s("div",T,[s("p",U,d(e.name),1),s("p",$,d(e.desc),1)]),n.value===e.id?(o(),t("span",G,"選択中")):D("",!0)],10,O)),64))]),a[4]||(a[4]=s("h2",null,"显示模块",-1)),s("div",H,[(o(),t(_,null,y(b,e=>s("label",{key:e.id,class:"module-row"},[F(s("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":a[0]||(a[0]=p=>m.value=p)},null,8,J),[[L,m.value]]),s("div",null,[s("p",K,d(e.name),1),s("p",Q,d(e.desc),1)])])),64))]),s("div",W,[s("button",{class:"btn",type:"button",disabled:r.value,onClick:k},d(r.value?"保存中...":"保存"),9,X)])]))]))}}),se=N(Y,[["__scopeId","data-v-8fdbd3b0"]]);export{se as default};
