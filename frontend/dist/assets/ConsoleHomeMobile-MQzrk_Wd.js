import{d as R,$ as j,r as x,c,g as V,B as z,o as H,a as d,e as t,t as i,i as J,j as u,h as O,F as U,f as q,a1 as G,u as K,b as m,_ as Q}from"./index-X7Vbb3kp.js";const W={class:"console-home"},X={class:"hero-card"},Y={class:"hero-heading"},Z=["src"],tt={class:"hero-title"},st={class:"hero-role"},et={class:"hero-stats"},ot={class:"hero-stat"},nt={class:"hero-stat"},at={class:"hero-stat"},lt={class:"action-grid"},it={class:"events-section"},ct={class:"event-cards"},ut=["onClick"],rt={class:"event-date"},dt={class:"event-meta"},mt={key:0,class:"event-empty"},r="https://raw.githubusercontent.com/moreard/dev-assets/main/socialmore/icon-action-default.png",vt=R({__name:"ConsoleHomeMobile",setup(pt){const l=K(),p=j(),y=x([]),g=x(!1),v=c(()=>p.getActiveCommunity()),E=c(()=>{var e;return((e=v.value)==null?void 0:e.name)??""}),o=c(()=>p.activeCommunityId.value),n=c(()=>!!o.value),M=c(()=>{var e;return((e=v.value)==null?void 0:e.avatarUrl)||"https://raw.githubusercontent.com/moreard/dev-assets/main/socialmore/default-community.png"}),S=c(()=>{var s;switch((s=v.value)==null?void 0:s.role){case"owner":return"主催者";case"admin":return"管理者";default:return"メンバー"}}),b=c(()=>({monthRevenueText:"¥0",eventCount:y.value.length,registrationCount:"--"})),C=c(()=>y.value.slice(0,5).map(e=>({id:e.id,title:V(e.title),status:e.status,dateTimeText:D(e.startTime,e.endTime),entrySummary:e.visibility==="public"?"公開イベント":"限定公開",coverUrl:"https://placehold.co/120x120?text=Event"}))),h=async()=>{if(o.value){g.value=!0;try{y.value=await G(o.value)}catch(e){console.error("Failed to load console events",e)}finally{g.value=!1}}};z(o,()=>{o.value&&h()});const T=()=>{window.dispatchEvent(new CustomEvent("console:open-community-picker"))},f=()=>{l.push({name:"ConsoleMobileCommunityCreate"})},I=()=>{l.push({name:"ConsoleMobilePayout"})},A=()=>{l.push({name:"ConsoleMobileSubscription"})},k=()=>{o.value&&l.push({name:"ConsoleMobileCommunitySettings",params:{communityId:o.value}})},L=()=>{var e;(e=v.value)!=null&&e.slug&&l.push({name:"community-portal",params:{slug:v.value.slug}})},_=()=>{o.value&&l.push({name:"ConsoleMobileCommunityEvents",params:{communityId:o.value}})},P=e=>{l.push({name:"ConsoleMobileEventManage",params:{eventId:e}})},B=()=>{o.value&&l.push({name:"ConsoleMobileEventForm",params:{communityId:o.value}})},$=()=>{o.value&&l.push({name:"ConsoleMobileEventCreate",params:{communityId:o.value}})},D=(e,s)=>{const a=new Date(e).toLocaleString("ja-JP",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});if(!s)return a;const w=new Date(s).toLocaleString("ja-JP",{hour:"2-digit",minute:"2-digit"});return`${a}〜${w}`},F=e=>{switch(e){case"open":return"受付中";case"closed":return"終了";default:return"下書き"}},N=e=>{switch(e){case"open":return"bg-emerald-100 text-emerald-700";case"closed":return"bg-slate-100 text-slate-500";default:return"bg-amber-100 text-amber-700"}};return H(async()=>{await p.loadCommunities(),o.value||p.ensureActiveCommunity(),o.value&&h()}),(e,s)=>(m(),d("div",W,[t("section",X,[t("div",Y,[t("img",{src:M.value,alt:"avatar",class:"hero-avatar",onClick:k},null,8,Z),t("div",{class:"hero-heading-text",onClick:k},[t("h1",tt,i(E.value||"未選択のコミュニティ"),1),t("p",st,i(n.value?`役割: ${S.value}`:"まずはコミュニティを登録"),1)]),n.value?(m(),d("button",{key:0,class:"hero-switch inline-switch",type:"button",onClick:T}," 切り替え ")):(m(),d("button",{key:1,class:"hero-switch hero-switch--primary",type:"button",onClick:f},[...s[0]||(s[0]=[t("span",{class:"i-lucide-sparkles"},null,-1),J(" コミュニティを作成 ",-1)])]))]),t("div",et,[t("div",ot,[s[1]||(s[1]=t("p",null,"今月の収入",-1)),t("strong",null,i(n.value?b.value.monthRevenueText:"---"),1)]),t("div",nt,[s[2]||(s[2]=t("p",null,"今月のイベント",-1)),t("strong",null,i(n.value?b.value.eventCount:"--"),1)]),t("div",at,[s[3]||(s[3]=t("p",null,"申込数",-1)),t("strong",null,i(n.value?b.value.registrationCount:"--"),1)])])]),t("section",lt,[t("button",{class:"action-card",type:"button",onClick:f},[t("div",{class:"action-entry"},[t("div",{class:"action-icon"},[t("img",{src:r,alt:""})]),s[4]||(s[4]=t("div",null,[t("p",{class:"action-title"},"コミュニティ作成"),t("p",{class:"action-desc"},"新しいコミュニティを登録")],-1))])]),t("button",{class:u(["action-card",{"is-disabled":!n.value}]),type:"button",onClick:B},[t("div",{class:"action-entry"},[t("div",{class:"action-icon"},[t("img",{src:r,alt:""})]),s[5]||(s[5]=t("div",null,[t("p",{class:"action-title"},"新しいイベント"),t("p",{class:"action-desc"},"イベントを作成して公開")],-1))])],2),t("button",{class:u(["action-card",{"is-disabled":!n.value}]),type:"button",onClick:$},[t("div",{class:"action-entry"},[t("div",{class:"action-icon"},[t("img",{src:r,alt:""})]),s[6]||(s[6]=t("div",null,[t("p",{class:"action-title"},"AI イベント助手"),t("p",{class:"action-desc"},"SOCIALMORE 憲法で企画")],-1))])],2),t("button",{class:u(["action-card",{"is-disabled":!n.value}]),type:"button",onClick:_},[t("div",{class:"action-entry"},[t("div",{class:"action-icon"},[t("img",{src:r,alt:""})]),s[7]||(s[7]=t("div",null,[t("p",{class:"action-title"},"イベント管理"),t("p",{class:"action-desc"},"登録状況と参加者を確認")],-1))])],2),t("button",{class:u(["action-card",{"is-disabled":!n.value}]),type:"button",onClick:I},[t("div",{class:"action-entry"},[t("div",{class:"action-icon"},[t("img",{src:r,alt:""})]),s[8]||(s[8]=t("div",null,[t("p",{class:"action-title"},"収益と入金"),t("p",{class:"action-desc"},"入金設定・請求を確認")],-1))])],2),t("button",{class:u(["action-card",{"is-disabled":!n.value}]),type:"button",onClick:A},[t("div",{class:"action-entry"},[t("div",{class:"action-icon"},[t("img",{src:r,alt:""})]),s[9]||(s[9]=t("div",null,[t("p",{class:"action-title"},"プランと設定"),t("p",{class:"action-desc"},"プラン変更や通知設定")],-1))])],2),t("button",{class:u(["action-card",{"is-disabled":!n.value}]),type:"button",onClick:L},[t("div",{class:"action-entry"},[t("div",{class:"action-icon"},[t("img",{src:r,alt:""})]),s[10]||(s[10]=t("div",null,[t("p",{class:"action-title"},"公開ページを見る"),t("p",{class:"action-desc"},"社群ポータルを確認（ユーザー側表示）")],-1))])],2)]),t("section",it,[t("div",{class:"section-head"},[s[11]||(s[11]=t("div",null,[t("p",{class:"section-label"},"イベントの進行状況"),t("h2",null,"最新イベント")],-1)),t("button",{class:"link-button",type:"button",onClick:_},"一覧を見る")]),t("div",ct,[(m(!0),d(U,null,q(C.value,a=>(m(),d("button",{key:a.id,class:"event-card",type:"button",onClick:w=>P(a.id)},[t("div",{class:u(["event-status",N(a.status)])},i(F(a.status)),3),t("p",rt,i(a.dateTimeText),1),t("h3",null,i(a.title),1),t("p",dt,i(a.entrySummary),1)],8,ut))),128)),C.value.length?O("",!0):(m(),d("div",mt," まだイベントがありません。新しい企画を始めましょう。 "))])])]))}}),bt=Q(vt,[["__scopeId","data-v-5504fe9f"]]);export{bt as default};
